<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.23" /><meta name="theme" content="VuePress Theme Plume 1.0.0-rc.152" /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"智能合约开发","image":[""],"dateModified":null,"author":[]}</script><meta property="og:url" content="https://web3intern.xyz/zh/smart-contract-development/"><meta property="og:site_name" content="Web3 实习手册"><meta property="og:title" content="智能合约开发"><meta property="og:description" content="本章将围绕 Web3 行业中的智能合约工程师所需的技能进行介绍，首先介绍去中心化应用（Dapp）的基本架构，重点分析其与传统应用的不同之处。接着，我们将详细讨论开发 Dapp 的流程，从需求分析、智能合约的编写、前端与后端的设计，到最终部署和上线，帮助读者理解整个开发生命周期。 一、Dapp 架构和开发流程 去中心化应用（Dapp）是与传统集中式应用不..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><link rel="icon" type="image/png" href="/images/ethpanda.png"><title>智能合约开发 | Web3 实习手册</title><meta name="description" content="本章将围绕 Web3 行业中的智能合约工程师所需的技能进行介绍，首先介绍去中心化应用（Dapp）的基本架构，重点分析其与传统应用的不同之处。接着，我们将详细讨论开发 Dapp 的流程，从需求分析、智能合约的编写、前端与后端的设计，到最终部署和上线，帮助读者理解整个开发生命周期。 一、Dapp 架构和开发流程 去中心化应用（Dapp）是与传统集中式应用不..."><link rel="preload" href="/assets/style-BcCk_2ad.css" as="style"><link rel="stylesheet" href="/assets/style-BcCk_2ad.css"><link rel="modulepreload" href="/assets/app-BJ-erunQ.js"><link rel="modulepreload" href="/assets/index.html-Cb1Ytu63.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-d90a7a26><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-d5a8d0bc></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-d5a8d0bc> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-d90a7a26 data-v-e98a6132><div class="vp-navbar" vp-navbar data-v-e98a6132 data-v-2c31ea5e><div class="wrapper" data-v-2c31ea5e><div class="container" data-v-2c31ea5e><div class="title" data-v-2c31ea5e><div class="vp-navbar-title has-sidebar" data-v-2c31ea5e data-v-1a4f50af><a class="vp-link no-icon link title" href="/" data-v-1a4f50af data-v-17a67ebe><!--[--><!--[--><!--]--><!----><span data-v-1a4f50af>Web3 实习手册</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-2c31ea5e><div class="content-body" data-v-2c31ea5e><!--[--><!--]--><div class="vp-navbar-search search" data-v-2c31ea5e><div class="search-wrapper" data-v-97535d1e><!----><div id="local-search" data-v-97535d1e><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-97535d1e><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-2c31ea5e data-v-d43c1732><span id="main-nav-aria-label" class="visually-hidden" data-v-d43c1732>Main Navigation</span><!--[--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/zh/" tabindex="0" data-v-d43c1732 data-v-d4acf911 data-v-17a67ebe><!--[--><!----><span data-v-d4acf911>开始阅读</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/blob/main/CONTRIBUTING.md" target="_blank" rel="noreferrer" tabindex="0" data-v-d43c1732 data-v-d4acf911 data-v-17a67ebe><!--[--><!----><span data-v-d4acf911>参与和支持</span><!----><!--]--><span class="vpi-external-link icon" data-v-17a67ebe></span></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/zh/acknowledgments/" tabindex="0" data-v-d43c1732 data-v-d4acf911 data-v-17a67ebe><!--[--><!----><span data-v-d4acf911>致谢名单</span><!----><!--]--><!----></a><!--]--><!--]--></nav><!--[--><!--]--><div class="vp-flyout vp-navbar-translations translations" data-v-2c31ea5e data-v-f5263507 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="选择语言" data-v-86530b6c><span class="text" data-v-86530b6c><!----><span class="vpi-languages option-icon" data-v-86530b6c></span><!----><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><!----><!--[--><!--[--><div class="items" data-v-f5263507><p class="title" data-v-f5263507>简体中文</p><!--[--><div class="vp-menu-link" data-v-f5263507 data-v-1ff1855f><a class="vp-link no-icon link" href="/" data-v-1ff1855f data-v-17a67ebe><!--[--><!----> English <!----><!--]--><!----></a></div><!--]--></div><!--]--><!--]--></div></div></div><!----><div class="vp-social-links vp-navbar-social-links social-links" data-v-2c31ea5e data-v-ad52545c data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="https://github.com/ethpanda-org/Web3-Internship-Handbook" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-2c31ea5e data-v-652282fd data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-86530b6c><span class="vpi-more-horizontal icon" data-v-86530b6c></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><!----><!--[--><!--[--><div class="group translations" data-v-652282fd><p class="trans-title" data-v-652282fd>简体中文</p><!--[--><div class="vp-menu-link" data-v-652282fd data-v-1ff1855f><a class="vp-link no-icon link" href="/" data-v-1ff1855f data-v-17a67ebe><!--[--><!----> English <!----><!--]--><!----></a></div><!--]--></div><!----><div class="group" data-v-652282fd><div class="item social-links" data-v-652282fd><div class="vp-social-links social-links-list" data-v-652282fd data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="https://github.com/ethpanda-org/Web3-Internship-Handbook" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-2c31ea5e data-v-2b50024d><span class="container" data-v-2b50024d><span class="top" data-v-2b50024d></span><span class="middle" data-v-2b50024d></span><span class="bottom" data-v-2b50024d></span></span></button></div></div></div></div><div class="divider" data-v-2c31ea5e><div class="divider-line" data-v-2c31ea5e></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-d90a7a26 data-v-3944d8e8><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-3944d8e8><span class="vpi-align-left menu-icon" data-v-3944d8e8></span><span class="menu-text" data-v-3944d8e8>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-3944d8e8 data-v-4114a62c><button data-v-4114a62c>返回顶部</button><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-d90a7a26 data-v-95211354><div class="curtain" data-v-95211354></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-95211354><span id="sidebar-aria-label" class="visually-hidden" data-v-95211354> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0" data-v-473fd05b data-v-12048f0f><!----><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Web3 实习手册</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-473fd05b data-v-12048f0f><div class="item" role="button" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><h2 class="text" data-v-12048f0f><span data-v-12048f0f>入门导读</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/blockchain-basic/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>区块链基础概念</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/overview-of-ethereum/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>以太坊概览</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/industry-knowledge/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>行业赛道全览</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/remote-work-guide/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Web3 工作方式</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible has-active" data-v-473fd05b data-v-12048f0f><div class="item" role="button" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><h2 class="text" data-v-12048f0f><span data-v-12048f0f>Web3 行业知识</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/position-introduction/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>区块链岗位全景图</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/smart-contract-development/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>智能合约开发</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/community-intern/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>社区运营指南</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/security/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>合规和网络安全</span><span class="vp-badge info vp-menu-badge" style="" data-v-12048f0f data-v-12255704><!--[-->待更新<!--]--></span></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-473fd05b data-v-12048f0f><div class="item" role="button" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><h2 class="text" data-v-12048f0f><span data-v-12048f0f>行业前辈访谈录</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/logic-frontend-journey/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>前端先锋的链上闯关之路</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/jason-web2-to-web3-journey/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Web2 到 Web3 的转型之路</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/julie-community-growth-expert/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Web3 社区增长专家</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/bruce-hiring-perspective/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>如何成为靠谱的 Web3 实习生</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-473fd05b data-v-12048f0f><div class="item" role="button" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><h2 class="text" data-v-12048f0f><span data-v-12048f0f>面试准备与行业岗位推荐</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/job-platform/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>招聘平台与职位推荐</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/write-resume/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Web3 行业简历撰写指导</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/interview-preparedness/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>面试准备与典型面试题</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-473fd05b data-v-12048f0f><div class="item" role="button" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><h2 class="text" data-v-12048f0f><span data-v-12048f0f>附录</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/appendix/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>附录</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0" data-v-473fd05b data-v-12048f0f><!----><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link no-icon link link" href="/zh/acknowledgments/" data-v-12048f0f data-v-17a67ebe><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>致谢名单</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-d90a7a26 data-v-b2beaca7><div class="vp-doc-container has-sidebar has-aside" data-v-b2beaca7 data-v-23f6ad98><!--[--><!--]--><div class="container" data-v-23f6ad98><div class="aside" vp-outline data-v-23f6ad98><div class="aside-curtain" data-v-23f6ad98></div><div class="aside-container" data-v-23f6ad98><div class="aside-content" data-v-23f6ad98><div class="vp-doc-aside" data-v-23f6ad98 data-v-5976474c><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-5976474c data-v-aa56eba0><div class="content" data-v-aa56eba0><div class="outline-marker" data-v-aa56eba0></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-aa56eba0><span data-v-aa56eba0>此页内容</span><span class="vpi-print icon" data-v-aa56eba0></span></div><ul class="root" data-v-aa56eba0 data-v-3e6b023c><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-5976474c></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-23f6ad98><div class="content-container" data-v-23f6ad98><!--[--><!--]--><main class="main" data-v-23f6ad98><nav class="vp-breadcrumb" data-v-23f6ad98 data-v-1ae4ad7a><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-1ae4ad7a><!--[--><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link no-icon link breadcrumb" href="/" property="item" typeof="WebPage" data-v-1ae4ad7a data-v-17a67ebe><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="首页" data-v-1ae4ad7a><meta property="position" content="1" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><span class="vp-link no-icon breadcrumb" property="item" typeof="WebPage" data-v-1ae4ad7a data-v-17a67ebe><!--[-->Web3 行业知识<!--]--><!----></span><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="Web3 行业知识" data-v-1ae4ad7a><meta property="position" content="2" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link no-icon link breadcrumb current" href="/zh/smart-contract-development/" property="item" typeof="WebPage" data-v-1ae4ad7a data-v-17a67ebe><!--[-->智能合约开发<!--]--><!----></a><!----><meta property="name" content="智能合约开发" data-v-1ae4ad7a><meta property="position" content="3" data-v-1ae4ad7a></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-27be53cb>智能合约开发 <!----></h1><div class="vp-doc-meta" data-v-27be53cb><!--[--><!--]--><p class="reading-time" data-v-27be53cb><span class="vpi-books icon" data-v-27be53cb></span><span data-v-27be53cb>约 12862 字</span><span data-v-27be53cb>大约 43 分钟</span></p><!----><!--[--><!--]--><p class="create-time" data-v-27be53cb><span class="vpi-clock icon" data-v-27be53cb></span><span data-v-27be53cb>2025-06-12</span></p></div><!--]--><!--[--><!--]--><div class="_zh_smart-contract-development_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-23f6ad98><!--[--><!--]--><div data-v-23f6ad98><blockquote><p>本章将围绕 Web3 行业中的智能合约工程师所需的技能进行介绍，首先介绍去中心化应用（Dapp）的基本架构，重点分析其与传统应用的不同之处。接着，我们将详细讨论开发 Dapp 的流程，从需求分析、智能合约的编写、前端与后端的设计，到最终部署和上线，帮助读者理解整个开发生命周期。</p></blockquote><h2 id="一、dapp-架构和开发流程" tabindex="-1"><a class="header-anchor" href="#一、dapp-架构和开发流程"><span>一、Dapp 架构和开发流程</span></a></h2><p>去中心化应用（Dapp）是与传统集中式应用不同的全新应用模式，通常运行在区块链或分布式网络上。与传统应用相比，Dapp 的核心特点在于去中心化，意味着应用的逻辑和数据不由单一实体控制，而是由多个参与者共同维护。因此，开发 Dapp 需要理解和掌握去中心化技术栈、智能合约编程以及前端与区块链的交互方式。</p><h3 id="_1-dapp-架构" tabindex="-1"><a class="header-anchor" href="#_1-dapp-架构"><span>1. Dapp 架构</span></a></h3><p>Dapp 的架构主要由三个核心部分组成：</p><p><mark>1. <strong>前端（User Interface）</strong>：</mark></p><ul><li>前端是 Dapp 与用户交互的界面，通常由 HTML、CSS 和 JavaScript（如 React、Vue 等框架）构建。与传统 Web 应用不同，Dapp 前端会连接区块链来调用智能合约，呈现数据和执行交易。</li><li>前端还需要集成区块链钱包（如 MetaMask）来进行身份验证和签署交易，确保用户的隐私和安全。</li></ul><p><mark>2. <strong>智能合约（Smart Contracts）</strong>：</mark></p><ul><li>智能合约是 Dapp 的核心，它定义了应用的业务逻辑，并部署在区块链上。智能合约通过执行自动化的规则来确保交易和操作的透明性与不可篡改性。</li><li>在以太坊平台上，智能合约通常使用 <strong>Solidity</strong> 编程语言编写，并通过 <strong>Ethereum Virtual Machine (EVM)</strong> 执行。</li></ul><p><mark>3. <strong>数据检索器（Indexer）</strong>：</mark></p><ul><li>智能合约通常以 <code>Event</code> 形式释放日志事件，比如释放代表 NFT 转移的 <code>Transfer</code> 事件，数据检索器会检索这些数据并将其写入到 PostgreSQL 等传统数据库中</li><li>Dapp 在前端进行数据展示时需要检索器内的数据。一个简单的示例是某 NFT 项目需要展示用户持有的所有 NFT，但是 NFT 合约并不会提供通过输入地址参数返回该地址下的所有 NFT 的函数，此时我们可以运行数据检索器将 <code>Transfer</code> 事件读取后写入传统数据库内，前端可以在传统数据库内检索用户持有的 NFT 数据</li></ul><p><mark>4. <strong>区块链和去中心化存储（Blockchain &amp; Decentralized Storage）</strong>：</mark></p><ul><li>区块链用于存储智能合约的状态数据及交易记录。去中心化存储如 <strong>IPFS</strong>（InterPlanetary File System）或 <strong>Arweave</strong>，用于存储大规模的非结构化数据（如图片、文档等），确保数据不易丢失和篡改。</li><li>通过使用去中心化存储，Dapp 确保所有数据在多个节点上备份，保证数据的持久性和去中心化特性。</li></ul><h3 id="_2-dapp-开发流程" tabindex="-1"><a class="header-anchor" href="#_2-dapp-开发流程"><span>2. Dapp 开发流程</span></a></h3><p>Dapp 的开发流程可以分为以下几个阶段：</p><figure><img src="/assets/dapp_development-workflow_01-sGuU6DCd.jpg" alt="Dapp 开发流程图" tabindex="0"><figcaption>Dapp 开发流程图</figcaption></figure><div class="vp-steps"><ol><li><p><strong>需求分析与规划</strong></p><p>在开发 Dapp 之前，首先需要进行需求分析和规划，明确应用的目标和功能。此阶段包括：</p><ul><li><strong>确定功能需求</strong>：需要定义用户可以进行的操作，比如转账、查询余额、创建投票等。</li><li><strong>选择区块链平台</strong>：决定在哪个平台上构建 Dapp（如以太坊、Solana、Polygon 等），这通常取决于目标用户群、交易成本、可扩展性等因素。</li><li><strong>设计用户体验（UX）</strong>：定义 Dapp 的界面设计和交互流程，确保用户能够轻松使用应用并与区块链交互。</li></ul></li><li><p><strong>智能合约开发</strong></p><p>智能合约是 Dapp 的核心，负责执行去中心化的业务逻辑和存储重要的数据。在这一阶段，开发者需要：</p><ul><li><strong>编写智能合约</strong>：使用 <strong>Solidity</strong> 或其他智能合约语言编写合约，确保合约的功能满足需求分析中定义的要求。</li><li><strong>编写测试用例</strong>：为智能合约编写单元测试，确保合约逻辑正确、无漏洞。</li><li><strong>审计和优化</strong>：对合约进行安全审计，确保合约的安全性，避免常见漏洞（如重入攻击、整数溢出等）。</li></ul></li><li><p><strong>检索器开发</strong></p><p>检索器是获取链上数据的核心，负责捕获智能合约释放的事件并以合理的方式将其存入数据库的不同的表内部。在这一阶段，开发者需要:</p><ul><li><strong>确定功能需要的数据内容</strong>: 前端使用的数据大部份都直接来自检索器，所以开发者需要确定前端工程师所需要的数据</li><li><strong>编写检索器程序</strong>: 目前主流的检索器框架，如 ponder 和 subgraph 都是用了 TypeScript 语言作为检索器的程序编写语言，开发者主要编写事件数据清理以及事件数据写入数据库的代码</li><li><strong>部署和运维</strong>: 编写程序完成后，一般使用 Docker 部署到云服务器中，当然目前很多检索器框架也提供 SaaS 服务，同时检索器作为一个常规的数据库应用需要运维</li></ul></li><li><p><strong>前端开发</strong></p><p>前端是用户与 Dapp 交互的主要界面，因此开发前端时需要：</p><ul><li><strong>选择前端框架</strong>：可以使用现代前端框架（如 <strong>React</strong>、<strong>Vue</strong>）来构建 UI。前端将通过 JavaScript 与智能合约进行交互。</li><li><strong>连接钱包</strong>：通过集成 <strong>MetaMask</strong> 等 Web3 钱包，用户可以连接到 Dapp，并授权其与智能合约交互。</li><li><strong>显示区块链数据</strong>：前端需要从区块链和检索器内获取数据（如账户余额、交易记录），并通过用户界面展示。</li><li><strong>处理交易签名与确认</strong>：当用户发起交易时，前端需要与钱包进行交互，获取用户的签名并将交易发送到区块链。</li></ul></li><li><p><strong>与区块链交互</strong></p><p>前端和智能合约通过 <strong>Viem</strong>（推荐）、<strong>Ethers.js</strong> 或 <strong>Wagmi</strong> 等现代化库进行交互。这些库提供更好的 TypeScript 支持和性能优化：</p><ul><li><strong>读取数据</strong>：前端通过智能合约的公共函数读取区块链上的状态数据（如余额、合约信息）。</li><li><strong>发送交易</strong>：当用户发起交易时，前端需要通过钱包签署交易并发送到区块链，执行合约中的某个功能（如转账）。</li></ul></li><li><p><strong>部署与上线</strong></p><p>一旦开发完成，Dapp 进入部署阶段。具体步骤包括：</p><ul><li><strong>部署智能合约</strong>：推荐使用 <strong>Hardhat</strong> 或 <strong>Foundry</strong>（现代化开发工具）将智能合约部署到测试网（如 <strong>Sepolia</strong>、<strong>Holesky</strong>）或主网。</li><li><strong>前端部署</strong>：将前端应用部署到去中心化平台（如 <strong>IPFS</strong>）或传统的 Web 服务（Vercel）。</li><li><strong>发布和维护</strong>：将 Dapp 上线，进行用户反馈收集，定期更新合约和前端，修复潜在问题。</li></ul></li></ol></div><h3 id="_3-小结" tabindex="-1"><a class="header-anchor" href="#_3-小结"><span>3. 小结</span></a></h3><p>Dapp 的开发流程从需求分析、智能合约编写、前端开发，到最终部署，涵盖了多个技术栈的综合应用。开发 Dapp 时，区块链技术的透明性、不可篡改性以及智能合约的自动执行能力为应用提供了去中心化的基础。但与此同时，开发者需要应对与传统 Web 应用不同的挑战，如用户体验、交易处理以及安全性问题。</p><h2 id="二、以太坊开发环境搭建" tabindex="-1"><a class="header-anchor" href="#二、以太坊开发环境搭建"><span>二、以太坊开发环境搭建</span></a></h2><p>以太坊开发环境的搭建主要有以下几种常用方式，适合不同的开发需求：</p><h3 id="_1-基础环境准备" tabindex="-1"><a class="header-anchor" href="#_1-基础环境准备"><span>1. 基础环境准备</span></a></h3><ul><li>Node.js（建议用 nvm 管理）</li><li>npm 或 yarn</li><li>Git</li></ul><p>开发环境安装命令（如未安装）：</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 安装 nvm（如未装）。推荐参考文档 https://github.com/nvm-sh/nvm 安装最新版本</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -o-</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.s</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">h</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 安装 Node.js LTS</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nvm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --lts</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nvm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> use</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --lts</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 安装 yarn（可选）</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">npm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -g</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> yarn</span></span></code></pre></div><hr><h3 id="_2-以太坊本地开发链" tabindex="-1"><a class="header-anchor" href="#_2-以太坊本地开发链"><span>2. 以太坊本地开发链</span></a></h3><p><strong>方式一：Foundry（Rust 实现，极快）</strong></p><ul><li><a href="https://getfoundry.sh/introduction/getting-started" target="_blank" rel="noopener noreferrer">Foundry 官方文档</a> - https://getfoundry.sh/introduction/getting-started</li></ul><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -L</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://foundry.paradigm.xy</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">z</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> bash</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">foundryup</span></span></code></pre></div><p><strong>初始化项目</strong></p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">forge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> init</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Counter</span></span></code></pre></div><p><strong>测试合约</strong></p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Compile your contracts</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">forge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Run your test suite</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">forge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test</span></span></code></pre></div><p><strong>启动本地节点</strong></p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">chisel</span></span></code></pre></div><p><strong>部署合约</strong></p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Use forge scripts to deploy contracts</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Set your private key</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> PRIVATE_KEY</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Deploy to local anvil instance</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">forge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> script</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> script/Counter.s.sol</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --rpc-url</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://127.0.0.1:8545</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --broadcast</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --private-key</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $PRIVATE_KEY</span></span></code></pre></div><hr><p><strong>方式二：Hardhat（推荐，现代以太坊开发框架）</strong></p><ul><li><a href="https://hardhat.org/tutorial" target="_blank" rel="noopener noreferrer"><strong>Hardhat 官方教程</strong></a> - 含视频指导</li></ul><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">npm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --global</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> hardhat</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> eth-dev</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &amp;&amp;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> eth-dev</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">npx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> hardhat</span></span></code></pre></div><p>选择“创建一个基本示例项目”，会自动生成合约、测试和配置。</p><p><strong>启动本地节点</strong></p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">npx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> hardhat</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> node</span></span></code></pre></div><p><strong>部署合约</strong></p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">npx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> hardhat</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> scripts/deploy.js</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --network</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> localhost</span></span></code></pre></div><hr><h3 id="_3-以太坊钱包和前端交互" tabindex="-1"><a class="header-anchor" href="#_3-以太坊钱包和前端交互"><span>3. 以太坊钱包和前端交互</span></a></h3><ul><li>推荐使用 MetaMask 浏览器插件作为开发钱包。</li><li>前端推荐使用 Viem 和 Wagmi。</li></ul><hr><h3 id="_4-其他常用工具" tabindex="-1"><a class="header-anchor" href="#_4-其他常用工具"><span>4. 其他常用工具</span></a></h3><ul><li>Remix IDE（网页版，适合快速测试合约）：<a href="https://remix.ethereum.org/" target="_blank" rel="noopener noreferrer">https://remix.ethereum.org</a></li><li>OpenZeppelin 合约库：<code>npm install @openzeppelin/contracts</code></li><li><a href="https://docs.chain.link/resources/link-token-contracts" target="_blank" rel="noopener noreferrer"><strong>Chainlink 测试环境</strong></a> - 预言机集成指南</li></ul><h2 id="三、solidity-智能合约编程-简单介绍" tabindex="-1"><a class="header-anchor" href="#三、solidity-智能合约编程-简单介绍"><span>三、Solidity 智能合约编程（简单介绍）</span></a></h2><p>Solidity 是一种面向合约的高级编程语言，专门用于在以太坊虚拟机（EVM）上编写智能合约。它具有静态类型、支持继承、库和复杂的用户定义类型等特性。</p><h3 id="_1-基础语法与开发范式" tabindex="-1"><a class="header-anchor" href="#_1-基础语法与开发范式"><span>1. 基础语法与开发范式</span></a></h3><div class="vp-steps"><ol><li><p><strong>版本声明</strong></p><p>每个 Solidity 文件必须以版本声明开始：</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">pragma</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> solidity</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> ^0.8.0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span></code></pre></div></li><li><p><strong>数据类型</strong></p><p>基本数据类型</p><table><thead><tr><th>类型</th><th>描述</th><th>示例</th><th>默认值</th></tr></thead><tbody><tr><td>bool</td><td>布尔值</td><td>true / false</td><td>false</td></tr><tr><td>uint8</td><td>8 位无符号整数</td><td>0 ~ 255</td><td>0</td></tr><tr><td>uint16</td><td>16 位无符号整数</td><td>0 ~ 65535</td><td>0</td></tr><tr><td>uint256 / uint</td><td>256 位无符号整数</td><td>0 ~ (2^256 - 1)</td><td>0</td></tr><tr><td>int8</td><td>8 位有符号整数</td><td>-128 - 127</td><td>0</td></tr><tr><td>int256 / int</td><td>256 位有符号整数</td><td>-2^255 ~ (2^255 - 1)</td><td>0</td></tr><tr><td>address</td><td>以太坊地址</td><td>0x….</td><td>0</td></tr><tr><td>bytes1 ~ bytes32</td><td>固定长度字节数组</td><td>bytes32 data = &quot;Hello&quot;</td><td>0x00</td></tr><tr><td>bytes</td><td>动态字节数组</td><td>bytes memory data = &quot;Hello World&quot;</td><td>&quot;&quot;</td></tr><tr><td>string</td><td>UTF-8 编码字符串</td><td>string name = &quot;Alice&quot;</td><td>&quot;&quot;</td></tr></tbody></table><p>复合数据类型</p><table><thead><tr><th>类型</th><th>语法</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td>静态数组</td><td>T[k]</td><td>固定长度数组</td><td>uint[5] numbers</td></tr><tr><td>动态数组</td><td>T[]</td><td>可变长度数组</td><td>uint[] memory list</td></tr><tr><td>映射</td><td>mapping(K =&gt; V)</td><td>键值对存储</td><td>mapping(address =&gt; uint256) balances</td></tr><tr><td>结构体</td><td>struct</td><td>自定义数据结构</td><td><code>struct Person { string name; uint age; }</code></td></tr><tr><td>枚举</td><td>enum</td><td>枚举类型</td><td><code>enum Status { Pending, Active, Inactive }</code></td></tr></tbody></table></li><li><p><strong>函数修饰符</strong></p><p>可见性修饰符表</p><table><thead><tr><th>修饰符</th><th>可见范围</th><th>描述</th><th>使用场景</th></tr></thead><tbody><tr><td>public</td><td>内部 + 外部</td><td>任何地方都可以调用</td><td>对外提供的公共接口</td></tr><tr><td>external</td><td>仅外部</td><td>只能从合约外部调用</td><td>外部用户接口，gas 效率更高</td></tr><tr><td>internal</td><td>内部 + 继承</td><td>当前合约和子合约可调用</td><td>内部逻辑函数，需要被继承</td></tr><tr><td>private</td><td>仅内部</td><td>只有当前合约可调用</td><td>私有实现细节</td></tr></tbody></table><p>状态修饰符表</p><table><thead><tr><th>修饰符</th><th>状态读取</th><th>状态修改</th><th>Gas 消耗</th><th>描述</th></tr></thead><tbody><tr><td>pure</td><td>❌</td><td>❌</td><td>低</td><td>不读取也不修改状态的函数</td></tr><tr><td>view</td><td>✅</td><td>❌</td><td>低</td><td>只读取状态，不修改状态</td></tr><tr><td>payable</td><td>✅</td><td>✅</td><td>正常</td><td>可以接收以太币的函数</td></tr><tr><td>无修饰符</td><td>✅</td><td>✅</td><td>正常</td><td>可以读取和修改状态</td></tr></tbody></table></li><li><p><strong>开发范式</strong></p><ul><li><p><strong>状态机模式</strong></p><p>智能合约本质上是一个状态机，通过交易改变合约状态。</p></li><li><p><strong>事件驱动编程</strong></p><p>使用事件（Events）记录重要的状态变化，便于前端监听和日志记录。</p></li><li><p><strong>模块化设计</strong></p><p>通过继承和库（Library）实现代码复用和模块化。</p></li></ul></li></ol></div><h3 id="_2-合约结构详解" tabindex="-1"><a class="header-anchor" href="#_2-合约结构详解"><span>2. 合约结构详解</span></a></h3><div class="vp-steps"><ol><li><p><strong>基本结构</strong></p><ol><li><code>//</code> 是 Solidity 中的单行注释符号，例如：<code>// SPDX-License-Identifier: MIT</code> 用于指定源代码的许可证类型。</li><li><code>pragma</code> 关键字用于声明 Solidity 源代码所需的编译器版本，确保合约在兼容的编译器环境中正确编译。</li><li><code>contract</code> 关键字用于定义一个智能合约，其语法格式为：<code>contract 合约名 { ... }</code>。</li><li>一个智能合约的基本结构通常由以下三部分组成：状态变量、构造函数和普通函数。</li></ol><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// SPDX-License-Identifier: MIT</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">pragma</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> solidity</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> ^0.8.0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> MyContract</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 状态变量</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    uint256</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> myNumber</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 构造函数</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    constructor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        myNumber </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 100</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 函数</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> setNumber</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _number</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        myNumber </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _number</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p><strong>状态变量（State Variables）</strong></p><p>状态变量是指在合约中定义的、其值永久存储在区块链上的变量。它们用于记录合约的持久化数据，构成了合约的整体状态。当合约被部署后，这些变量将被写入区块链，并在合约的整个生命周期中保持可访问性和可追踪性。</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> MyContract</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    /*</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    * 可以通过内部与外部函数更改变量</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    * public可以通过前端代码访问</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    */</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    uint256</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> totalSupply</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    mapping</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> private</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> owner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 常量</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    uint256</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> constant</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> MAX_SUPPLY </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1000000</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 不可变量（构造函数中设置一次）</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    uint256</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> immutable</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> deploymentTime</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    constructor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        owner </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        deploymentTime </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> block</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">timestamp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        totalSupply </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p><strong>函数（Functions）</strong></p><p>函数是 Solidity 智能合约中执行具体逻辑操作的核心组成部分。通过函数，可以实现对状态变量的读取、修改，或执行特定业务逻辑。</p><p><strong>函数声明格式</strong></p><p>Solidity 中函数的标准声明格式如下所示：</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">function </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">函数名</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">参数列表</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    &lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">可见性</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    &lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">状态可变性</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    &lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">修饰符列表</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    &lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">虚拟</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">/</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">重写关键字</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">&lt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">返回值列表</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 函数体</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p>各部分含义如下：</p><ul><li><code>&lt;函数名&gt;</code>：函数的名称；</li><li><code>&lt;参数列表&gt;</code>：传入函数的参数；</li><li><code>&lt;可见性修饰符&gt;</code>：如 <code>public</code>、<code>private</code>、<code>internal</code>、<code>external</code>；</li><li><code>&lt;状态可变性修饰符&gt;</code>：如 <code>view</code>、<code>pure</code>、<code>payable</code>；</li><li><code>&lt;函数修饰符&gt;</code>：如 <code>onlyOwner</code> 等自定义逻辑控制；</li><li><code>virtual/override</code>：用于支持继承与函数重写；</li><li><code>returns</code>：定义返回值及其类型。</li></ul><p><strong>函数可见性（Function Visibility）</strong></p><p>函数可见性决定了函数在何种上下文中可以被调用</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> VisibilityExample</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 仅当前合约可访问</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> privateFunc</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> private</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> pure</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> return</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> }</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 当前合约和继承合约可访问</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> internalFunc</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> internal</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> pure</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> return</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> }</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 所有人可访问</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> publicFunc</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> pure</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> return</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> }</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 仅外部调用</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> externalFunc</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> pure</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> return</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><strong>函数状态修饰符</strong>（State Mutability Modifiers）</p><p>用于指明函数是否修改或读取合约状态：</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> StateModifiers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    uint256</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> count </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // view: 只读函数，不修改状态</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> getCount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> view</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> count</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // pure: 纯函数，不读取也不修改状态</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> add</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> b</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> pure</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> a </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">+</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> b</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // payable: 可接收以太币</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> deposit</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> payable</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // msg.value 是发送的以太币数量</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 默认：可修改状态</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> increment</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        count</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><strong>函数参数和返回值</strong></p><p>Solidity 支持多参数与多返回值，以及命名返回值：</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 多个返回值</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> getPersonInfo</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> pure</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> memory</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> age</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    name </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Alice&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    age </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 25</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 命名返回值</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> calculate</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> b</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> pure</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> sum</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> product</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    sum </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> a </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">+</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> b</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    product </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> a </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">*</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> b</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 自动返回命名变量</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 调用带多返回值的函数</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> callExample</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> pure</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> memory</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> age</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> getPersonInfo</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 或者忽略某些返回值</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    (,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> productOnly</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> calculate</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">5</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><strong>修饰符（Function Modifiers）</strong></p><p>修饰符允许在函数执行前插入额外逻辑，常用于权限控制与前置检查：</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> ModifierExample</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> owner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    bool</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> paused </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    constructor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        owner </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 自定义修饰符</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    modifier</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> onlyOwner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> owner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Not the owner&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        _</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 继续执行被修饰的函数</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    modifier</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> whenNotPaused</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">!</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">paused</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Contract is paused&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        _</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> togglePause</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> onlyOwner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        paused </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">paused</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 使用多个修饰符</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> criticalFunction</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> onlyOwner</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> whenNotPaused</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 函数逻辑</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><strong>继承与函数重写（Inheritance and Override）</strong></p><p>Solidity 支持单继承与多继承，子合约可重写父合约中的函数：</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 基础合约</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> Animal</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    constructor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> memory</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _name) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        name </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> speak</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> virtual</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> memory</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Some sound&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 继承合约</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> Dog</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> is</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> Animal</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    constructor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> memory</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _name) </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Animal</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">_name) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 重写父类函数</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> speak</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> pure</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> override</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> memory</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Woof!&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 多重继承</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> Pet</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> is</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> Animal</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> owner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    constructor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> memory</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> address</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _owner) </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Animal</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">_name) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        owner </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _owner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> Labrador</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> is</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> Dog</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">Pet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    constructor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> memory</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> address</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _owner)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        Dog</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">_name)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        Pet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">_name, _owner) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><strong>接口与抽象合约（Interfaces &amp; Abstract Contracts）</strong></p><p>接口与抽象合约用于定义规范与继承框架：</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 接口定义</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">interface</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> IERC20</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> transfer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> to</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> balanceOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> account</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> view</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 抽象合约</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">abstract</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> AbstractToken</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 没有函数体的抽象函数，必须被子类使用 override 关键词重载实现</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> totalSupply</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> virtual</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 有函数体实现的抽象函数，子类可以不使用 override 关键词重载直接继承已有的实现，也可以选择使用 override 关键词重载实现</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> decimals</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> view</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> virtual</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint8</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 18</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><strong>事件机制（Events）</strong></p><p>事件用于在链上记录重要状态变化，并可由外部监听器（如检索器或前端应用）捕捉：</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> EventExample</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 定义事件</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    event</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> Transfer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> indexed</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> indexed</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> to</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    event</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> Approval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> indexed</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> owner</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> indexed</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> spender</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    mapping</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> transfer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> to</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Insufficient balance&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> -</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">to</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 触发事件</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 可以在区块链浏览器查找到当前事件记录</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        emit</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> Transfer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> to</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div></li></ol></div><h3 id="_3-安全实践" tabindex="-1"><a class="header-anchor" href="#_3-安全实践"><span>3. 安全实践</span></a></h3><p>常见攻击手段</p><table><thead><tr><th>风险点</th><th>攻击机理</th><th>典型防护措施</th></tr></thead><tbody><tr><td>Reentrancy</td><td>恶意合约在 transfer / call 回调中再次进入受害函数，导致重复提款</td><td>1. Checks-Effects-Interactions <br> 2. <code>ReentrancyGuard</code>（OpenZeppelin）<br> 3. 使用 <code>transfer</code>/<code>send</code> 或限制 gas（已不推荐，仅旧代码）</td></tr><tr><td>访问控制 (Access Control)</td><td>未受保护的管理函数可被任何人调用</td><td>1. <code>Ownable</code>：<code>onlyOwner</code> 修饰符 <br> 2. <code>AccessControl</code>：基于角色的权限（<code>DEFAULT_ADMIN_ROLE</code>, <code>MINTER_ROLE</code> 等）<br> 3. 及时转移 / 多签管理</td></tr><tr><td>整数溢出 (Integer Overflow / Underflow)</td><td>旧版本 <code>&lt;0.8</code> 加法/减法越界产生错误数值</td><td>1. Solidity 0.8+ 默认内置溢出检查 <br> 2. 对老版本使用 <code>SafeMath</code> 库</td></tr></tbody></table><div class="vp-steps"><ol><li><p><strong>重入攻击（Reentrancy）防护</strong></p><p>重入攻击（Reentrancy Attack）是智能合约中最常见且危害极大的安全漏洞之一。该攻击方式通常发生在合约向外部地址发送以太币或调用外部合约函数时，攻击者利用回调机制在合约状态更新之前重复调用受影响的函数，从而多次提取资金或重复执行某些操作，造成资产损失或逻辑混乱。</p><p><strong>攻击原理简述</strong></p><p>典型的重入攻击流程如下：</p><ol><li>合约调用外部合约或地址（如 <code>call</code> 发送以太币）；</li><li>外部合约在其回调函数中重新调用原合约尚未更新状态的函数；</li><li>原合约在状态尚未变更的前提下再次执行逻辑；</li><li>攻击者反复进入该函数，实现多次提现等恶意操作。</li></ol><p><strong>典型示例（易受攻击版本）</strong></p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> VulnerableContract</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    mapping</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> withdraw</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">        uint256</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">];</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">amount </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;No balance&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 危险：先转账，后更新状态</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">bool</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> success</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">value</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}(</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">success</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Transfer failed&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 状态更新在转账之后</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><strong>防护措施</strong></p><ol><li>检查-生效-交互模式（CEI Pattern）</li></ol><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> SecureContract</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    mapping</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> withdraw</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">        uint256</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">];</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">amount </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;No balance&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 先更新状态</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 后进行外部调用</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">bool</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> success</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">value</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}(</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">success</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Transfer failed&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><ol start="2"><li>重入锁（Reentrancy Guard）</li></ol><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> ReentrancyGuard</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    bool</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> private</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> locked</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    modifier</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> noReentrant</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">!</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">locked</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Reentrant call&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        locked </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        _</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        locked </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> SecureWithGuard</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> is</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> ReentrancyGuard</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    mapping</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> withdraw</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> noReentrant</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">        uint256</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">];</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">amount </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;No balance&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        balances</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">bool</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> success</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">value</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}(</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">success</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Transfer failed&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p><strong>访问控制（Access Control）</strong></p><p>访问控制是保障智能合约安全性的核心机制之一。通过对关键函数设置访问权限，可以有效防止未经授权的用户执行敏感操作，从而避免资金被盗、状态被篡改等严重安全风险。</p><p><strong>缺乏访问控制的风险示例</strong></p><p>以下为一个存在严重安全漏洞的合约示例，任何地址均可提取合约内全部资金：</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">/**</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">* </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">@title</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> BadVault</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">* </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">@dev</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> 缺少访问控制，任何人都能调用 withdraw() 取走全部 ETH</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">*/</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> BadVault</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    mapping</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> balance</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 用户存钱</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> deposit</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> payable</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        balance</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> msg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">value</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // ❌ anyone can withdraw ALL funds!</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> withdraw</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        payable</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">transfer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">balance</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><strong>问题题说明</strong>： 该合约未对 withdraw 函数设置访问权限，攻击者可通过简单调用提取合约内所有以太币，造成资金全部流失。</p><p><strong>安全的访问控制示例</strong></p><p>通过引入显式权限判断，限制敏感操作的调用者，可以提升合约的安全性：</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">/**</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">* </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">@title</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> SafeVault</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">* </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">@dev</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> 仅部署者 (owner) 可以提取资金，简单显式访问控制</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">*/</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> SafeVault</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> immutable</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> owner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">           // 部署者地址</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    mapping</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> balance</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 构造函数：在部署时确定所有者地址</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    constructor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> owner_</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        owner </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> owner_</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 存款函数：允许所有用户调用</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> deposit</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> payable</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        balance</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> msg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">value</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // ✔️ 提款函数：仅限所有者调用</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> withdraw</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 进行访问权限判断</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> owner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Not owner&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">        uint256</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">balance</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">amount </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Nothing to withdraw&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 注意 Checks-Effects-Interactions 顺序</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">bool</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ok</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> )</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> owner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">value</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> amount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}(</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ok</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Transfer failed&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p><strong>整数溢出防护（Integer Overflow Protection）</strong></p><p>在早期版本的 Solidity（v0.8.0 之前），算术运算默认<strong>不进行溢出检查</strong>。这意味着当整数变量超出其最大值或最小值时，数值将<strong>环绕（wrap around）</strong>，导致严重的逻辑漏洞和安全隐患。</p><p><strong>受攻击的示例：无溢出检测的合约（&lt; v0.8.0）：</strong></p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">pragma</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> solidity</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> ^0.7.6</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">          // ⚠️ 0.7 版本不会自动检查溢出</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">/**</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">* </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">@title</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> BadCounter</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">* </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">@dev</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> 用户每调用一次 `inc()`，计数器加 1；当计数器达到 10 停止奖励。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">*      但整数溢出可让攻击者将计数器绕回 0，再无限领奖。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">*/</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> BadCounter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    mapping</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> counter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    mapping</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> rewarded</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 计数 +1</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> inc</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        counter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 若已 2**256-1 则回到 0</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 满 10 次领取 1 wei</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> claim</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">counter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;not enough actions&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">!</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">rewarded</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    &quot;already claimed&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        rewarded</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">transfer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">           // 为演示简化为 1 wei</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 向合约注入少量 ETH 供演示</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    receive</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> payable</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><strong>问题说明：</strong> 在该合约中，如果攻击者的 counter 达到最大值 2^256 - 1，再次调用 inc() 会使计数器绕回 0，从而绕过 &gt;=10 的检查条件，并再次触发奖励逻辑，实现无限循环领取。</p><p><strong>安全方案：限制上限 + 使用最新编译器版本</strong></p><p>自 Solidity 0.8.0 起，所有算术运算默认开启溢出/下溢检查，若发生异常会自动 <code>revert</code>。除此之外，也建议通过逻辑限制控制最大值，防止边界绕回。</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">/**</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">* </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">@title</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> SafeCounter</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">* </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">@dev</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> 方案：在 inc() 中直接固定“最高 11”，超过即拒绝。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">*      溢出永远不会发生，也杜绝了重复领奖。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">*/</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> SafeCounter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    mapping</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> counter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    uint8</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> constant</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> MAX_ACTIONS </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 11</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">   // 上限 11，留 1 个缓冲</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    /// 受控递增：达到 10 后就不准再加</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> inc</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">counter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> MAX_ACTIONS</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;limit reached&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        counter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    /// 领取奖励</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> claim</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">counter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;≥10 actions required&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        counter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                   // 重置为 0</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">bool</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ok</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> )</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">value</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}(</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ok</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;transfer failed&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    /// 注资</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    receive</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> external</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> payable</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div></li></ol></div><h2 id="四、智能合约实战项目" tabindex="-1"><a class="header-anchor" href="#四、智能合约实战项目"><span>四、智能合约实战项目</span></a></h2><p>本章节将通过一个简单的&quot;链上留言板&quot;项目，介绍如何使用 Remix 开发、编译、部署并调用智能合约。</p><h3 id="_1-环境准备" tabindex="-1"><a class="header-anchor" href="#_1-环境准备"><span>1. 环境准备</span></a></h3><p>推荐使用 <a href="https://remix.ethereum.org/" target="_blank" rel="noopener noreferrer">Remix IDE</a>，它是一个基于浏览器的在线集成开发环境，提供完整的 Solidity 编写、编译、部署与调试功能，适合初学者快速上手。</p><figure><img src="/assets/remix_ide-interface-display_01-EPYB4AZc.png" alt="Remix IDE 界面展示" tabindex="0"><figcaption>Remix IDE 界面展示</figcaption></figure><h3 id="_2-合约代码" tabindex="-1"><a class="header-anchor" href="#_2-合约代码"><span>2. 合约代码</span></a></h3><p>本项目的智能合约实现了一个链上留言功能。每个用户地址可以在区块链上提交一条留言信息，所有留言将永久保存在链上，具有不可篡改与可溯源的特点。</p><div class="language-solidity" data-highlighter="shiki" data-ext="solidity" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-solidity"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// SPDX-License-Identifier: MIT</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">pragma</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> solidity</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> ^0.8.0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">contract</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> MessageBoard</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 保存所有人的留言记录</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    mapping</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> string</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[])</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> messages</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 留言事件，便于检索器和区块链浏览器追踪</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    event</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> NewMessage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> indexed</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> sender</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">string</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 构造函数，在部署时留言一条欢迎词</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    constructor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">        string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> memory</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> initMsg </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;Hello ETH Pandas&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        messages</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">push</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">initMsg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        emit</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> NewMessage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> initMsg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 发送一条留言</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> leaveMessage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> memory</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _msg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        messages</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">push</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">_msg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     // 添加到发言记录</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        emit</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> NewMessage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">msg.sender</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _msg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">   // 发出事件</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 查询某人第 n 条留言（从 0 开始）</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> getMessage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> user</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> uint256</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> index</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> view</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">string</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> memory</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> messages</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">user</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">][</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">index</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">];</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 查询某人一共发了多少条</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> getMessageCount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">address</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> user</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> view</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> returns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uint256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> messages</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">user</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">length</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><h3 id="_3-新建合约文件" tabindex="-1"><a class="header-anchor" href="#_3-新建合约文件"><span>3. 新建合约文件</span></a></h3><p>在 Remix IDE 左侧文件管理面板（File Explorer）中，点击&quot;新建文件&quot;按钮，创建一个名为 <code>messageboard.sol</code> 的 Solidity 合约文件，并将合约代码粘贴至该文件中。</p><figure><img src="/assets/remix_code-editing_01-BEnQoyDH.png" alt="Remix 编辑代码" tabindex="0"><figcaption>Remix 编辑代码</figcaption></figure><h3 id="_4-编译" tabindex="-1"><a class="header-anchor" href="#_4-编译"><span>4. 编译</span></a></h3><ol><li>在 Remix 右侧面板中选择 <strong>Solidity Compiler</strong>，进入编译设置界面；</li><li>在 <strong>COMPILER VERSION</strong> 下拉菜单中选择与合约代码版本一致的编译器版本；</li><li>点击 <strong>Compile messageboard.sol</strong> 按钮以启动编译过程；</li><li>若编译成功，将在面板右上角看到绿色的 ✅ 符号；</li><li>若编译失败，错误信息将显示在底部命令行终端中。根据提示修改代码后可重新编译。</li></ol><p>如需重新组织项目结构，可点击 <strong>FILE EXPLORER</strong> 创建文件夹以便分类管理文件。</p><figure><img src="/assets/remix_compile-contract_01-DPzprCvt.png" alt="Remix 编译界面" tabindex="0"><figcaption>Remix 编译界面</figcaption></figure><h3 id="_5-部署" tabindex="-1"><a class="header-anchor" href="#_5-部署"><span>5. 部署</span></a></h3><ul><li>在 Remix 右侧面板中选择 <strong>Deploy &amp; Run Transactions</strong>，进入部署与交互界面；</li><li>默认环境选择为 JavaScript VM，本地虚拟区块链，系统将自动为多个账户分配初始余额（每个账户默认 100 ETH），可用于部署与调用合约时支付 Gas 费用；</li></ul><figure><img src="/assets/remix_deploy-interface_01-CtzY0ei1.png" alt="Remix 部署界面" tabindex="0"><figcaption>Remix 部署界面</figcaption></figure><ul><li>确认部署合约的合约名无误后，点击 <strong>Deploy</strong> 按钮，即可完成部署；</li><li>部署成功后，在下方面板将显示合约部署地址、可调用函数列表及状态变量</li></ul><figure><img src="/assets/remix_deploy-success_01-DvQKujmN.png" alt="Remix 部署成功" tabindex="0"><figcaption>Remix 部署成功</figcaption></figure><ul><li>展开底部命令终端可查看部署日志及构造函数的执行信息，验证合约初始化情况与留言功能的准备状态。</li></ul><figure><img src="/assets/remix_deploy-logs_01-_eSRyWR8.png" alt="Remix 部署日志" tabindex="0"><figcaption>Remix 部署日志</figcaption></figure><h3 id="_6-调用函数" tabindex="-1"><a class="header-anchor" href="#_6-调用函数"><span>6. 调用函数</span></a></h3><p>部署完成后，即可在 Remix 中调用合约的留言函数：</p><ol><li>在合约实例中找到 <code>leaveMessage</code> 函数输入框；</li><li>在输入框中填入留言内容（例如：<code>Hello World</code>）；</li><li>点击 <strong>leaveMessage</strong> 按钮，发起交易调用；</li><li>右侧命令终端将显示一条新的交易记录，点击该记录可查看交易详情与链上存储的留言信息。</li></ol><figure><img src="/assets/remix_function-call_01-CPWF7iBn.png" alt="Remix 函数调用" tabindex="0"><figcaption>Remix 函数调用</figcaption></figure><h2 id="五、以太坊技术基础" tabindex="-1"><a class="header-anchor" href="#五、以太坊技术基础"><span>五、以太坊技术基础</span></a></h2><h3 id="_1-帐户模型" tabindex="-1"><a class="header-anchor" href="#_1-帐户模型"><span>1. 帐户模型</span></a></h3><table><thead><tr><th>对比维度</th><th>外部拥有账户 <strong>EOA</strong></th><th>合约账户 <strong>Contract Account</strong></th></tr></thead><tbody><tr><td>地址来源</td><td><code>keccak256(pubKey)[12:]</code>   (公钥 → 地址)</td><td>创建时由 <code>CREATE/CREATE2</code> 计算</td></tr><tr><td>控制方式</td><td><strong>私钥签名</strong>（用户、钱包）</td><td><strong>合约代码</strong>（EVM 字节码）</td></tr><tr><td>状态字段</td><td><code>nonce</code>、<code>balance</code></td><td><code>nonce</code>、<code>balance</code>、<code>codeHash</code>、<code>storageRoot</code></td></tr><tr><td>能否发起交易</td><td>✅  必须用私钥签名</td><td>❌  只能由 EOA 触发或合约内部调用</td></tr><tr><td>Gas 费用支付</td><td>由账户本身 ETH 余额承担</td><td>由调用者支付</td></tr><tr><td>典型场景</td><td>钱包地址、热冷账户</td><td>ERC-20/721 Token、DeFi 协议、DAO</td></tr></tbody></table><h3 id="_2-gas-机制" tabindex="-1"><a class="header-anchor" href="#_2-gas-机制"><span>2. Gas 机制</span></a></h3><table><thead><tr><th>术语</th><th>含义</th><th>备注</th></tr></thead><tbody><tr><td><strong>Gas</strong></td><td>执行 1 条 EVM 指令的抽象工作量单位</td><td>汇编级别价格表见 <a href="https://www.evm.codes/" target="_blank" rel="noopener noreferrer">evm.codes</a></td></tr><tr><td><strong>Gas Limit (Tx)</strong></td><td>发送者愿为本笔交易消耗的 Gas 上限</td><td>防止死循环耗尽余额</td></tr><tr><td><strong>Gas Used</strong></td><td>实际执行指令花费的 Gas 总和</td><td>多退少不补</td></tr><tr><td><strong>Base Fee</strong></td><td>随区块动态调整的基础费用（EIP-1559）</td><td>全网销毁，抑制拍卖狂飙</td></tr><tr><td><strong>Priority Fee / Tip</strong></td><td>发送者给出以激励打包者的附加费</td><td>给矿工 / 验证者</td></tr><tr><td><strong>Max Fee Per Gas</strong></td><td><code>maxFee = baseFee + priorityFee</code> 上限</td><td>钱包通常自动估算</td></tr></tbody></table><h3 id="_3-交易生命周期" tabindex="-1"><a class="header-anchor" href="#_3-交易生命周期"><span>3. 交易生命周期</span></a></h3><ul><li><strong>签名构造</strong><ul><li>钱包收集字段：<code>nonce, to, value, data, gasLimit, maxFeePerGas, priorityFeePerGas, chainId</code></li><li>使用私钥生成 <code>v, r, s</code> 签名 → <strong>序列化 RLP</strong></li></ul></li><li><strong>广播到 P2P 网络</strong><ul><li>交易进入本地 &amp; 邻居节点的 <strong>mempool</strong></li><li>节点根据 <code>maxFeePerGas</code>、<code>gasLimit</code>、<code>nonce</code> 做基本筛查</li></ul></li><li><strong>打包 / 提议区块</strong><ul><li>验证者（PoS）或矿工（PoW 时代）挑选利润最高、合法顺序的交易</li><li>执行 EVM → 产生 <strong>交易收据</strong>（<code>status, gasUsed, logsBloom, logs[]</code>）</li></ul></li><li><strong>区块传播与共识</strong><ul><li>区块头包含新 <strong>stateRoot</strong>、<strong>receiptsRoot</strong></li><li>超 2⁄3 质押者签名后在共识层定案（PoS Finality ≈ 2 Epoch ≈ 64 slot ≈ ~12 min）</li></ul></li><li><strong>确认数 &amp; Finality</strong><ul><li>客户端/前端常以 <code>n ≥ 12</code> 作&quot;概率足够低&quot;确认</li><li>完全终结在 PoS 下由 <strong>Finality Gadget</strong>（Casper FFG）给出</li></ul></li></ul><h2 id="六、部署合约" tabindex="-1"><a class="header-anchor" href="#六、部署合约"><span>六、部署合约</span></a></h2><p>在第四章中，我们已经体验了使用 Remix 在本地虚拟机环境下部署合约的基本流程。然而，该过程仅为本地模拟，并未真正将合约发布到区块链网络。</p><p>接下来，我们将通过 <mark class="important"><strong>测试网络（Testnet）</strong></mark> 实现合约的正式部署，使其真正上链。</p><p><mark><strong>测试链部署的意义</strong></mark></p><p>测试网络是与主网结构一致的区块链网络，由真实的去中心化节点共同维护。与主网不同的是，测试网中的代币不具有实际经济价值，适用于：</p><article class="vp-card-wrapper" data-v-d13ff83d><!--[--><!----><!--]--><div class="body" data-v-d13ff83d><!--[--><ul><li>验证合约功能是否符合预期；</li><li>检查合约在不同场景下的行为稳定性；</li><li>发现并修复潜在的安全漏洞；</li><li>避免在主网部署时产生高额 Gas 费用或造成实际损失。</li></ul><!--]--></div></article><p>一旦在测试链中部署成功且运行稳定，才建议将合约迁移至以太坊主网，以降低研发与运维成本。</p><p><mark><strong>浏览器可见性</strong></mark></p><p>由于测试链同样由真实节点组成，部署在测试链上的合约也可以通过以太坊区块浏览器（如 Sepolia Etherscan）进行查询与验证。</p><p>您可以在浏览器中查看：</p><article class="vp-card-wrapper" data-v-d13ff83d><!--[--><!----><!--]--><div class="body" data-v-d13ff83d><!--[--><ul><li>合约部署地址；</li><li>所属交易哈希（Transaction Hash）；</li><li>发起者地址；</li><li>合约代码及 ABI；</li><li>状态变量和函数调用记录等。</li></ul><!--]--></div></article><h3 id="_1-测试网" tabindex="-1"><a class="header-anchor" href="#_1-测试网"><span>1. 测试网</span></a></h3><p>以太坊测试网（Ethereum Testnets）是用于开发、测试和部署智能合约的网络环境，它们模拟主网功能但使用无价值的测试代币，让开发者可以安全地进行实验而无需承担真实的经济成本。</p><table><thead><tr><th>名称</th><th>共识机制</th><th>状态</th><th>主要特点</th><th>适用场景</th></tr></thead><tbody><tr><td>Sepolia</td><td>PoS (权益证明)</td><td>活跃</td><td>长期支持的主要测试网，与主网最相似，稳定性高。</td><td>最终部署前测试，生产环境模拟，Dapp 集成测试</td></tr><tr><td>Holesky</td><td>PoS (权益证明)</td><td>活跃</td><td>专为验证者测试设计，大型网络规模，质押功能完整。</td><td>验证者节点测试， 质押协议开发，大规模网络测试。</td></tr></tbody></table><h3 id="_2-领取-sepolia-代币" tabindex="-1"><a class="header-anchor" href="#_2-领取-sepolia-代币"><span>2. 领取 Sepolia 代币</span></a></h3><p>在将合约部署至 Sepolia 测试网之前，需确保部署地址拥有足够的测试用 ETH（Sepolia ETH），以支付部署与调用智能合约所需的 Gas 费用。</p><div class="vp-steps"><ol><li><p><mark>获取 Sepolia 地址</mark></p><ol><li>打开 <a href="https://metamask.io/" target="_blank" rel="noopener noreferrer">MetaMask 钱包</a>，创建或导入钱包账户；</li><li>在网络选择栏中切换至 <strong>Sepolia 测试网络</strong>；</li><li>此时，您将获得一个以 <code>0x</code> 开头的以太坊地址，用于接收 Sepolia 测试币。<div class="vp-card-grid cols-1" style="grid-template-columns:repeat(1, 1fr);" data-v-1949d4f2><!--[--><article class="vp-card-wrapper" data-v-d13ff83d><!--[--><!----><!--]--><div class="body" data-v-d13ff83d><!--[--><figure><img src="/assets/metamask_network-selection_01-7vNNyEOF.png" alt="MetaMask 网络选择" tabindex="0"><figcaption>MetaMask 网络选择</figcaption></figure><!--]--></div></article><article class="vp-card-wrapper" data-v-d13ff83d><!--[--><!----><!--]--><div class="body" data-v-d13ff83d><!--[--><figure><img src="/assets/metamask_network-selection_02-BkSf219O.png" alt="MetaMask 网络选择" tabindex="0"><figcaption>MetaMask 网络选择</figcaption></figure><!--]--></div></article><!--]--></div></li></ol></li><li><p><mark>申请测试币</mark></p><p>可以通过以下水龙头（Faucet）网址申请 Sepolia 测试代币：</p><ul><li><a href="https://sepolia-faucet.pk910.de/" target="_blank" rel="noopener noreferrer">https://sepolia-faucet.pk910.de/</a></li></ul><p><mark class="note"><strong>操作步骤如下：</strong></mark></p><ol><li>打开上述网址；</li><li>在输入框中粘贴您的 <strong>Sepolia 测试地址</strong>；</li><li>点击 <strong>Start Mining</strong> 按钮，平台将自动为您启动工作量证明（Proof of Work）过程；</li><li>几分钟后，您将收到一定数量的 Sepolia ETH，自动打入对应地址。</li></ol><p><mark class="note"><strong>注意事项</strong></mark></p><ul><li>某些水龙头服务可能会对申请者的主网余额、GitHub 账号或 Twitter 活跃度进行校验；</li><li>若在上述网站申请时出现 IP 相关错误提示，请按照以下步骤操作： <ul><li>先完成网站的真人验证（Captcha）；</li><li>关闭 VPN 或代理服务；</li><li>重新点击 <strong>Start Mining</strong>；</li></ul></li><li>若该 Faucet 不可用，也可尝试其他公开的 Sepolia 水龙头服务<div class="vp-card-grid cols-1" style="grid-template-columns:repeat(1, 1fr);" data-v-1949d4f2><!--[--><article class="vp-card-wrapper" data-v-d13ff83d><!--[--><!----><!--]--><div class="body" data-v-d13ff83d><!--[--><figure><img src="/assets/sepolia_faucet-interface_01-iB6SHKF6.png" alt="Sepolia 水龙头界面" tabindex="0"><figcaption>Sepolia 水龙头界面</figcaption></figure><!--]--></div></article><article class="vp-card-wrapper" data-v-d13ff83d><!--[--><!----><!--]--><div class="body" data-v-d13ff83d><!--[--><figure><img src="/assets/sepolia_faucet-obtain_01-Bw9NgWTY.png" alt="Sepolia 水龙头获取" tabindex="0"><figcaption>Sepolia 水龙头获取</figcaption></figure><!--]--></div></article><!--]--></div></li></ul></li></ol></div><h3 id="_3-remix-部署到-sepolia" tabindex="-1"><a class="header-anchor" href="#_3-remix-部署到-sepolia"><span>3. Remix 部署到 Sepolia</span></a></h3><p>在完成合约编写、编译和测试币领取等准备工作后，接下来可通过 Remix IDE 将合约正式部署到 Sepolia 测试网络，实现&quot;上链&quot;操作。</p><div class="vp-steps"><ol><li><p><mark>Remix 编译部署</mark></p><p><mark class="note"><strong>连接钱包</strong></mark></p><p>打开 Remix IDE，点击右侧面板中的 <strong>Deploy &amp; Run Transactions</strong> 模块，在 <strong>Environment</strong> 下拉菜单中选择：</p><article class="vp-card-wrapper" data-v-d13ff83d><!--[--><!----><!--]--><div class="body" data-v-d13ff83d><!--[--><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Injected Provider - MetaMask</span></span></code></pre></div><p>Remix 将自动调用浏览器中的 MetaMask 钱包，并连接到当前所选网络（确保已切换至 Sepolia 测试网）。</p><!--]--></div></article><figure><img src="/assets/remix_connect-metamask_01-C_OR2X_o.png" alt="Remix 连接 MetaMask" tabindex="0"><figcaption>Remix 连接 MetaMask</figcaption></figure><p><mark class="note"><strong>编译合约</strong></mark></p><p>切换至<strong>Solidity Compiler</strong> 面板，点击 <strong>Compile messageboard.sol</strong> 对合约进行编译，确保无错误提示。</p><figure><img src="/assets/remix_compile-contract_01-DPzprCvt.png" alt="Remix 编译合约" tabindex="0"><figcaption>Remix 编译合约</figcaption></figure><p><mark class="note"><strong>部署合约</strong></mark></p><p>回到 <strong>Deploy &amp; Run Transactions</strong> 面板：</p><ul><li>确保合约名称与合约文件一致；</li><li>点击 <strong>Deploy</strong> 按钮；</li><li>MetaMask 会弹出交易确认窗口，展示 Gas 费用等信息；</li><li>点击 <strong>确认</strong> 提交交易。</li></ul><figure><img src="/assets/metamask_confirm-transaction_01-BRj__znQ.png" alt="MetaMask 确认交易" tabindex="0"><figcaption>MetaMask 确认交易</figcaption></figure><p><mark class="note"><strong>查看部署结果</strong></mark></p><p>部署完成后，Remix 下方的命令行终端将输出相关日志，包括：</p><ul><li>合约部署的交易哈希（Transaction Hash）；</li><li>部署成功的合约地址；</li><li>构造函数的执行信息；</li><li>可调用的函数与状态变量接口</li></ul><figure><img src="/assets/remix_deploy-result_01-BH2Q1NTq.png" alt="Remix 部署结果" tabindex="0"><figcaption>Remix 部署结果</figcaption></figure></li><li><p><mark>Etherscan 查看合约</mark></p><p>部署成功后，我们可以借助 <a href="https://sepolia.etherscan.io" target="_blank" rel="noopener noreferrer">Etherscan</a> （已默认选择测试网）区块浏览器 对部署过程及合约状态进行进一步验证与分析。</p><p><mark class="note"><strong>切换到 Sepolia 网络</strong></mark></p><ol><li>打开 <a href="https://etherscan.io/" target="_blank" rel="noopener noreferrer">Etherscan</a>；</li><li>在页面顶部的网络切换器中选择 <strong>Sepolia</strong> 测试网，或直接访问 <a href="https://sepolia.etherscan.io" target="_blank" rel="noopener noreferrer">https://sepolia.etherscan.io</a>。</li></ol><figure><img src="/assets/etherscan_network-selection_01-D1zHV0sR.png" alt="Etherscan 网络选择" tabindex="0"><figcaption>Etherscan 网络选择</figcaption></figure><p><mark class="note"><strong>通过交易哈希查看部署信息</strong></mark></p><p>部署合约时，MetaMask 会生成一条交易记录，其 <strong>Transaction Hash</strong> 可在 Remix 的命令终端或 MetaMask 历史记录中找到。将该哈希值粘贴到 Etherscan 的搜索框中，即可查看部署交易的详细信息，包括：</p><ul><li>交易发起地址（From）；</li><li>合约部署地址（To 会显示为 <em>Contract Creation</em>）；</li><li>Gas 使用量及费用；</li><li>区块确认数；</li><li>输入的合约字节码（Input Data）等。</li></ul><figure><img src="/assets/etherscan_transaction-details_01-5-3aC0M-.png" alt="Etherscan 交易详情" tabindex="0"><figcaption>Etherscan 交易详情</figcaption></figure><p><mark class="note"><strong>通过合约地址查看合约详情</strong></mark></p><ol><li>在 Remix 中复制合约部署成功后的地址（如示例地址：<code>0xfaC4dF6aA3b8265A96a7B269a55A88E2009F34Be</code>）；</li><li>在 Etherscan 搜索框中粘贴该地址并进入合约页面；</li><li>页面中将显示如下信息： <ul><li>当前余额（Balance）；</li><li>合约创建交易；</li><li>交互记录（若无交互，则显示为&quot;暂无 Transactions&quot;）；</li><li>发布者地址（Creator）；</li><li>合约代码（若已验证）等</li></ul></li></ol><figure><img src="/assets/etherscan_contract-details_01-DQYXrh8G.png" alt="Etherscan 合约详情" tabindex="0"><figcaption>Etherscan 合约详情</figcaption></figure><p><mark class="note"><strong>查看合约事件日志（Events）</strong></mark></p><p>即使该合约尚未发生函数调用或转账交易，也可以通过 Etherscan 的 <strong>Events</strong> 标签页查看部署过程中由构造函数或初始设置触发的事件。该功能有助于调试初始化逻辑和验证合约状态。</p><figure><img src="/assets/etherscan_event-logs_01-CmvqLae2.png" alt="Etherscan 事件日志" tabindex="0"><figcaption>Etherscan 事件日志</figcaption></figure></li><li><p><mark>合约交互</mark></p><p>完成部署后，我们可以使用 Remix 提供的图形界面与已部署的智能合约进行函数调用测试，实现链上交互，并通过 Etherscan 验证交易与日志记录。</p><p><mark class="note"><strong>通过 Remix 调用合约函数</strong></mark></p><ol><li>回到 Remix 的 <strong>Deploy &amp; Run Transactions</strong> 面板；</li><li>在已部署合约实例下，找到函数 <code>leaveMessage</code>；</li><li>在输入框中输入一条测试信息（例如：<code>Hello ETH</code>）；</li><li>点击 <code>leaveMessage</code> 按钮发起函数调用；</li><li>MetaMask 将弹出交易确认窗口，确认后即可发送交易；</li><li>Remix 下方的终端将显示交易成功日志，包括交易哈希（Tx Hash）。</li></ol><figure><img src="/assets/remix_contract-interaction_01-BTY2j6c5.png" alt="Remix 合约交互" tabindex="0"><figcaption>Remix 合约交互</figcaption></figure><p><mark class="note"><strong>通过 Etherscan 验证交互结果</strong></mark></p><ol><li>复制合约地址，再次访问 Sepolia Etherscan；</li><li>在搜索框粘贴合约地址，进入合约详情页面；</li><li>此时页面中将显示新增的一条交易（Transaction），即刚刚执行的函数调用记录；</li><li>点击该交易进入交易详情页；</li><li>在页面下方的 <strong>Logs</strong> 或 <strong>Event Logs</strong> 标签页中，可看到刚刚触发的事件日志，其中包含输入的留言内容等参数信息。</li></ol><figure><img src="/assets/etherscan_transaction-record_01-DtpJRPvT.png" alt="Etherscan 交易记录" tabindex="0"><figcaption>Etherscan 交易记录</figcaption></figure><figure><img src="/assets/etherscan_event-logs-display_01-Ppa14NRI.png" alt="Etherscan 事件日志显示" tabindex="0"><figcaption>Etherscan 事件日志显示</figcaption></figure></li></ol></div><h2 id="七、区块链前端整合" tabindex="-1"><a class="header-anchor" href="#七、区块链前端整合"><span>七、区块链前端整合</span></a></h2><h3 id="_1-前端与合约交互工作流程概览" tabindex="-1"><a class="header-anchor" href="#_1-前端与合约交互工作流程概览"><span>1. 前端与合约交互工作流程概览</span></a></h3><h4 id="_1-2-交互流程" tabindex="-1"><a class="header-anchor" href="#_1-2-交互流程"><span><mark>1.2 交互流程</mark></span></a></h4><ol><li><strong>初始化连接</strong>：前端检测并连接 Web3 提供者</li><li><strong>用户授权</strong>：请求用户授权访问钱包账户</li><li><strong>合约实例化</strong>：使用 ABI 和合约地址创建合约实例</li><li><strong>函数调用</strong>：通过合约实例调用智能合约函数</li><li><strong>交易签名</strong>：钱包对交易进行数字签名</li><li><strong>广播交易</strong>：将签名交易发送到区块链网络</li><li><strong>状态更新</strong>：获取交易结果并更新前端界面</li></ol><figure><img src="/assets/web3_development-tools-flow_01-2XDurtQc.jpg" alt="Web3 开发工具流程" tabindex="0"><figcaption>Web3 开发工具流程</figcaption></figure><h4 id="_1-2-关键技术栈" tabindex="-1"><a class="header-anchor" href="#_1-2-关键技术栈"><span><mark>1.2 关键技术栈</mark></span></a></h4><ul><li><strong>合约语言：</strong> 掌握 Solidity 等相关合约开发语言</li><li><strong>Web3.js/Ethers.js：</strong> JavaScript 库，提供区块链交互 API (当前 Web3.js/Ethers.js 库比较老旧，本技术只用来学习理解整体流程，可以使用 Viem、Wagmi 进行新项目开发)</li><li><strong>钱包连接器</strong>：如 RainbowKit、ConnectKit、WalletConnect、Web3Modal 等</li><li><strong>状态管理</strong>：React Context 等管理连接状态</li><li><strong>错误处理</strong>：网络异常、用户拒绝、Gas 不足等场景处理</li></ul><p>上述技术栈中，合约语言与一些前端 JS 区块交互的 API 最为基础，其他方面往往由其他厂商提供，如 RPC 节点、钱包等。</p><h3 id="_2-实例操作" tabindex="-1"><a class="header-anchor" href="#_2-实例操作"><span>2. 实例操作</span></a></h3><p>在第六章中，我们已成功将智能合约部署至测试网络。然而，仅部署合约并不足以实现用户交互。为此，本章节将通过构建一个基于 Web 的前端页面，使用户可以通过网页界面与区块链上的合约进行交互（如留言等操作），从而实现完整的链上功能闭环。</p><figure><img src="/assets/dapp_fullstack-architecture_01--d65ZX0Q.png" alt="Dapp 全栈架构图" tabindex="0"><figcaption>Dapp 全栈架构图</figcaption></figure><h4 id="_2-1-关键代码" tabindex="-1"><a class="header-anchor" href="#_2-1-关键代码"><span><mark>2.1 关键代码</mark></span></a></h4><p>本前端界面基于以下技术栈构建：</p><ul><li><strong>开发语言</strong>：HTML + JavaScript + CSS（单页面集成）</li><li><strong>代码规模</strong>：约 650 行</li><li><strong>核心依赖库</strong>：<code>Web3.js</code> —— 用于与以太坊区块链进行交互</li></ul><div class="hint-container note"><p class="hint-container-title">注</p><p>完整源代码参考地址 👉: <a href="https://github.com/JXChuangLab/JXChuangLab.github.io/blob/main/messageboard.html" target="_blank" rel="noopener noreferrer">messageboard.html - GitHub</a></p></div><p><mark class="note"><strong>连接钱包</strong></mark></p><p>前端通过调用浏览器中的以太坊钱包插件（如 MetaMask）提供的 API，实现用户地址的连接与授权操作。</p><div class="language-jsx" data-highlighter="shiki" data-ext="jsx" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-jsx"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> connectWallet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 1. 请求用户授权账户访问</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> accounts</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> window</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ethereum</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">request</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">({</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    method</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">eth_requestAccounts</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 2. 创建 Web3 实例</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  web3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> Web3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">window</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ethereum</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  account</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> accounts</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 3. 验证网络,本示例使用Sepolia 测试网</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> chainId</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> web3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">eth</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">getChainId</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">chainId</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !==</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 11155111</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // Sepolia 测试网</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 网络错误处理</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><mark class="note"><strong>合约 ABI 定义</strong></mark></p><ul><li>ABI（<strong>Application Binary Interface</strong>，应用二进制接口）是智能合约对外提供的接口描述规范。</li><li>在前端，ABI 以 JSON 格式定义，描述合约中的函数、参数、返回类型等。</li><li>ABI 是实现前端与合约交互的基础，前端可通过 ABI 调用对应函数、读取状态变量。</li></ul><div class="language-json" data-highlighter="shiki" data-ext="json" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">const contractABI = </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">        &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">inputs</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [],</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">        &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">stateMutability</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nonpayable</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">        &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">constructor</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    },</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">        &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">anonymous</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">        &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">inputs</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            {</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">                &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">indexed</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">                &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">internalType</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">address</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">                &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">name</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">sender</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">                &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">address</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            },</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            {</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">                &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">indexed</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">                &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">internalType</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">string</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">                &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">name</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">message</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">                &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">string</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        ],</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">        &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">name</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">NewMessage</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">        &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">event</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    },</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">    ......</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><p><mark class="note"><strong>合约实例化</strong></mark></p><p>完成 ABI 导入与钱包连接后，通过 Web3.js 创建合约实例，绑定合约地址与 ABI，从而可直接调用合约中的函数接口。</p><div class="language-jsx" data-highlighter="shiki" data-ext="jsx" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-jsx"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> setContract</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">contractAddress</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">value</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">trim</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 地址有效性验证</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">!</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">web3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">utils</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">isAddress</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 错误处理</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 创建合约实例</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  contract</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> web3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">eth</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Contract</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">contractABI</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><mark class="note"><strong>合约方法调用</strong></mark></p><p>写入操作（需要 Gas）</p><p><strong>核心概念</strong>：</p><ul><li><code>.send()</code> 方法用于执行状态改变的交易</li><li>需要指定 <code>from</code> 参数（发送者地址）</li><li>返回交易对象，包含 <code>transactionHash</code> 等信息</li><li>用户需要在钱包中确认交易并支付 gas 费用</li></ul><div class="language-jsx" data-highlighter="shiki" data-ext="jsx" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-jsx"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> leaveMessage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">messageInput</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">value</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">trim</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  try</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 调用合约的写入方法</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    const</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> tx</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> contract</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">methods</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">leaveMessage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">send</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">({</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      from</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> account</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 获取交易哈希</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">交易哈希:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> tx</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">transactionHash</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> catch</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">error</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 错误处理</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p>只读或模拟操作（免费）</p><ul><li><code>.call()</code> 方法用于执行只读查询或者模拟操作以判断某笔交易是否会成功</li><li>不需要 gas 费用，不会改变区块链状态</li><li>可以直接获取返回值</li></ul><div class="language-jsx" data-highlighter="shiki" data-ext="jsx" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-jsx"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> queryMessages</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">queryAddress</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">value</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">trim</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  try</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 调用只读方法获取留言数量</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    const</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> count</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> contract</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">methods</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">getMessageCount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 批量获取留言内容</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &lt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> count</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">      const</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> contract</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">methods</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">getMessage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">      // 处理消息内容</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> catch</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">error</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 错误处理</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p>通过上述操作，前端即可实现用户连接钱包、链上留言、读取留言记录等功能，构建一个完整可用的 Dapp 原型。至此你已经了解合约代码，合约上链，前端交互整个大概流程。</p><h2 id="八、高阶内容" tabindex="-1"><a class="header-anchor" href="#八、高阶内容"><span>八、高阶内容</span></a></h2><h3 id="_1-gas-优化" tabindex="-1"><a class="header-anchor" href="#_1-gas-优化"><span>1. Gas 优化</span></a></h3><div class="hint-container note"><p class="hint-container-title">基本原理与计量单位</p><ul><li>Gas 是 EVM 执行操作的单位。每条指令消耗固定的 gas。</li><li>优化目标是减少交易所需的总 gas，提高用户体验并降低成本。</li></ul></div><h4 id="常见优化技巧" tabindex="-1"><a class="header-anchor" href="#常见优化技巧"><span><mark>常见优化技巧</mark></span></a></h4><div class="vp-steps"><ol><li><p><strong>减少存储操作（Storage Write）</strong></p><ul><li><p>读取存储第一次需 2100 gas（后续 100 gas），而内存读取仅 3 gas。推荐多次访问同一存储数据时，将其缓存到内存以减少 SLOAD 次数</p></li><li><p>每次写入 <code>storage</code> 的成本高达 20,000 gas；优先使用 <code>memory</code>。</p></li><li><p>示例：</p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>// ❌ 非优化写法</span></span>
<span class="line"><span>mapping(address =&gt; uint256) public balances;</span></span>
<span class="line"><span>function deposit() public payable {</span></span>
<span class="line"><span>    balances[msg.sender] += msg.value;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// ✅ 优化写法（一次读，一次写）</span></span>
<span class="line"><span>function deposit() public payable {</span></span>
<span class="line"><span>    uint256 current = balances[msg.sender];</span></span>
<span class="line"><span>    balances[msg.sender] = current + msg.value;</span></span>
<span class="line"><span>}</span></span></code></pre></div></li></ul></li><li><p><strong>使用位压缩（Bit Packing）</strong></p><ul><li><p>将多个变量压缩到一个 <code>uint256</code> 中以节省存储空间。</p></li><li><p>示例：</p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>struct Packed {</span></span>
<span class="line"><span>    uint128 a;</span></span>
<span class="line"><span>    uint128 b;</span></span>
<span class="line"><span>}</span></span></code></pre></div></li></ul></li><li><p><strong>循环优化</strong></p><ul><li><p>减少不必要的运算，如 <code>array.length</code> 缓存到变量中。</p></li><li><p>示例：</p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>// ❌ 非优化</span></span>
<span class="line"><span>for (uint256 i = 0; i &lt; arr.length; i++) {</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>// ✅ 优化</span></span>
<span class="line"><span>uint256 len = arr.length;</span></span>
<span class="line"><span>for (uint i = 0; i &lt; len; ++i) {</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>}</span></span></code></pre></div></li></ul></li><li><p><strong>函数可见性选择</strong> - <code>external</code> 比 <code>public</code> 更节省 gas，适用于仅被外部调用的函数。</p></li></ol></div><h3 id="_2-合约安全" tabindex="-1"><a class="header-anchor" href="#_2-合约安全"><span>2. 合约安全</span></a></h3><div class="hint-container note"><p class="hint-container-title">安全设计原则</p><ul><li>最小权限原则（Least Privilege）</li><li>模块化结构便于审计</li><li>显式错误处理与事件记录</li></ul></div><h4 id="常见漏洞类型与防护" tabindex="-1"><a class="header-anchor" href="#常见漏洞类型与防护"><span><mark>常见漏洞类型与防护</mark></span></a></h4><div class="vp-steps"><ol><li><p><strong>重入攻击 Reentrancy</strong></p><ul><li><p>利用外部合约在 fallback 中重新调用原函数。历史上最著名的 The DAO 事件便因重入漏洞导致约 6000 万美元 ETH 被盗，最终造成以太坊社区分裂（形成 ETH/ETC 链）。</p></li><li><p>防护方法：先更新状态，再转账。</p></li><li><p>示例：</p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>// ❌ 有漏洞</span></span>
<span class="line"><span>function withdraw() public {</span></span>
<span class="line"><span>    require(balance[msg.sender] &gt; 0);</span></span>
<span class="line"><span>    (bool sent,) = msg.sender.call{value: balance[msg.sender]}(&quot;&quot;);</span></span>
<span class="line"><span>    require(sent);</span></span>
<span class="line"><span>    balance[msg.sender] = 0;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// ✅ 修复后</span></span>
<span class="line"><span>function withdraw() public {</span></span>
<span class="line"><span>    uint256 amount = balance[msg.sender];</span></span>
<span class="line"><span>    balance[msg.sender] = 0;</span></span>
<span class="line"><span>    (bool sent,) = msg.sender.call{value: amount}(&quot;&quot;);</span></span>
<span class="line"><span>    require(sent);</span></span>
<span class="line"><span>}</span></span></code></pre></div></li></ul></li><li><p><strong>预言机操纵 Oracle Manipulation</strong></p><ul><li>依赖外部价格源的不可信更新。</li><li>解决方法： <ul><li>使用 Chainlink 等权威价格源。</li><li>增加时序约束和多源验证。</li><li>使用 TWAP 等加权算法。</li></ul></li></ul></li><li><p><strong>整数溢出/下溢</strong></p><ul><li>使用 <code>unchecked {}</code> 时需确保逻辑安全。</li><li>推荐使用Solidity 0.8+ 的内建溢出检查或 <code>SafeMath</code>。</li></ul></li><li><p><strong>权限控制缺失</strong></p><ul><li>所有管理函数应使用 <code>onlyOwner</code> 或 <code>AccessControl</code> 修饰符保护。</li></ul></li><li><p><strong>未初始化代理</strong></p><ul><li>基于代理模式的合约若未正确执行初始化函数，可能被任意人初始化并接管合约。</li><li>著名的例子包括 Harvest Finance 其在使用 Uniswap V3 做市策略的 Vault 合约中存在未初始化漏洞，如果被利用攻击者可销毁实现合约。该团队曾为此漏洞支付高额赏金修复。</li></ul></li><li><p><strong>前置交易/三明治攻击</strong></p><ul><li>攻击者在交易执行前后分别发送交易，以不利滑点或套利为目的。</li><li>例如 2025 年 3 月，一名用户在 Uniswap V3 的稳定币兑换中遭遇三明治攻击，约 21.5 万美元的 USDC 兑换几乎被抢跑，损失了 98% 的资金</li></ul></li></ol></div><h3 id="_3-智能合约审计" tabindex="-1"><a class="header-anchor" href="#_3-智能合约审计"><span>3. 智能合约审计</span></a></h3><div class="hint-container note"><p class="hint-container-title">审计必要性</p><ul><li>智能合约一旦部署无法修改，审计是风险控制关键手段。</li><li>资金安全：避免用户资产被盗。</li><li>法律合规：一些监管要求必须审计证明。</li></ul></div><h4 id="_3-1-常见的合约审计工具" tabindex="-1"><a class="header-anchor" href="#_3-1-常见的合约审计工具"><span>3.1 常见的合约审计工具</span></a></h4><ul><li><strong>Slither</strong>：以 Python 编写的静态分析工具，可检测安全漏洞和代码规范问题 <ul><li>常用命令为 <code>slither MyContract.sol</code>（也可指定合约地址）来扫描合约代码</li><li>使用方式：<a href="https://github.com/crytic/slither" target="_blank" rel="noopener noreferrer">Slither 官方文档</a> - https://github.com/crytic/slither</li></ul></li><li><strong>MythX</strong>：基于云平台的安全分析服务，支持命令行和 API 调用 <ul><li>使用 CLI 时，可执行类似 <code>mythx analyze MyContract.sol</code> 进行安全扫描</li><li>使用方式：<a href="https://github.com/ConsenSysDiligence/mythx-cli" target="_blank" rel="noopener noreferrer">github.com</a> - https://github.com/ConsenSysDiligence/mythx-cli</li></ul></li><li><strong>Foundry</strong>：高效的 Solidity 开发测试框架，支持属性测试（模糊测试）。 <ul><li>可使用 <code>forge test</code> 运行所有测试</li><li>使用方式：<a href="https://book.getfoundry.sh/forge/fuzz-testing" target="_blank" rel="noopener noreferrer">Foundry 模糊测试文档</a> - https://book.getfoundry.sh/forge/fuzz-testing，或通过 <code>forge test --match-path &lt;test 文件路径&gt;</code> 定向运行特定测试文件。</li></ul></li></ul><h4 id="_3-2-审计标准流程" tabindex="-1"><a class="header-anchor" href="#_3-2-审计标准流程"><span>3.2 审计标准流程</span></a></h4><figure><img src="/assets/solidity_audit-process_01-BmQERWd9.jpg" alt="Solidity 审计流程" tabindex="0"><figcaption>Solidity 审计流程</figcaption></figure><ol><li><strong>静态分析（Static Analysis）</strong>：使用工具如 Slither、Mythril 扫描代码缺陷</li><li><strong>动态测试（Fuzzing/Property Testing）</strong>：模拟攻击行为和极限条件</li><li><strong>人工审查（Manual Review）</strong>：由资深审计员检查业务逻辑漏洞</li><li><strong>审计报告生成（Audit Report）</strong>：明确发现的问题及修复建议</li></ol><h4 id="_3-3-知名审计机构比较" tabindex="-1"><a class="header-anchor" href="#_3-3-知名审计机构比较"><span>3.3 知名审计机构比较</span></a></h4><table><thead><tr><th>机构</th><th>特点</th><th>项目经验</th></tr></thead><tbody><tr><td>慢雾科技</td><td>国内领先，注重攻击复现</td><td>EOS、币安、火币等</td></tr><tr><td>OpenZeppelin</td><td>社区信赖度高，基础库作者</td><td>Compound、Balancer</td></tr><tr><td>ConsenSys Diligence</td><td>精通以太坊底层原理</td><td>Uniswap、1inch</td></tr></tbody></table><h3 id="_4-开发协作规范" tabindex="-1"><a class="header-anchor" href="#_4-开发协作规范"><span>4. <strong>开发协作规范</strong></span></a></h3><h4 id="_4-1-github-工作流" tabindex="-1"><a class="header-anchor" href="#_4-1-github-工作流"><span>4.1 GitHub 工作流</span></a></h4><figure><img src="/assets/github_workflow_01-CfLIb3sb.png" alt="GitHub 工作流程" tabindex="0"><figcaption>GitHub 工作流程</figcaption></figure><div class="vp-steps"><ul><li><p>分支策略：</p><ul><li><strong>主分支 (main/master)</strong>：始终保持可部署状态，任何代码合并前必须经过测试与审查。</li><li><strong>开发分支 (develop)</strong>：用于日常功能开发，作为 feature 分支的合并目标。</li><li><strong>功能分支 (feature/xxx)</strong>：以 <code>feature/功能描述</code> 命名，完成后合并至 develop 分支。</li><li><strong>修复分支 (fix/xxx)</strong>：针对 bug 的修复，以 <code>fix/bug-name</code> 命名，优先合并到 develop 或 main。</li><li><strong>发布分支 (release/xxx)</strong>：用于发布前准备，如版本打包、测试等，合并后删除。</li></ul></li><li><p>提交信息规范</p><ul><li><p>使用简洁明确的提交信息，推荐格式：</p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>类型: 简要描述</span></span>
<span class="line"><span></span></span>
<span class="line"><span>说明：可选的详细信息、动机、对比等</span></span>
<span class="line"><span>Issue：关联的 Issue 编号（如有）</span></span></code></pre></div></li><li><p>类型包括：</p><ul><li><code>feat</code>: 新功能</li><li><code>fix</code>: 修复问题</li><li><code>docs</code>: 文档更新</li><li><code>refactor</code>: 代码重构</li><li><code>test</code>: 添加或修改测试</li><li><code>chore</code>: 构建过程或辅助工具变动</li></ul></li></ul></li><li><p>Pull Request（PR）流程</p><ul><li><p>每个功能或修复应新建一个分支</p></li><li><p>提交 PR 前需确保：</p><ul><li><p>本地通过所有测试</p></li><li><p>通过 ESLint 或其他静态检查工具</p></li><li><p>包含必要的文档或注释</p></li><li><p>PR 标题应简洁明了，描述改动内容</p></li><li><p>不允许合并自己创建的 PR，需至少一位 reviewer 审查通过</p></li><li><p>可在项目仓库中添加 <code>PULL_REQUEST_TEMPLATE.md</code> 文件，可统一 PR 描述格式，提升协作效率。例如：</p><div class="language-jsx" data-highlighter="shiki" data-ext="jsx" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-jsx"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">## </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">PR</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> 说明</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> 变更内容</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">：</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">简要描述此次</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> PR</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> 完成了哪些功能或修复了哪些问题</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">。</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> 关联</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Issue</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">：</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">填写相关</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Issue</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> 编号</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">（</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">如无可留空</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">）。</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> 主要改动</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">：</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">列出代码改动的关键点</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">，</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">如新增哪些函数</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">、</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">修改哪些逻辑等</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">。</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> 测试情况</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">：</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">说明已编写或执行了哪些测试来验证改动</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">。</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> 影响评估</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">：</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">列出可能影响的模块或兼容性问题</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">（</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">如版本依赖</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">）。</span></span></code></pre></div></li><li><p>PR 标题应简洁表达功能，如 <code>feat: 添加 staking 功能</code></p></li><li><p>Code Review 检查清单（代码评审时可按以下要点逐项检查）：</p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>- 代码是否符合风格规范，命名清晰、可读性高？</span></span>
<span class="line"><span>- 业务逻辑是否正确，边界情况和异常情况是否处理周全？</span></span>
<span class="line"><span>- 安全性检查：是否考虑重入、整数溢出、权限校验、外部调用等风险？</span></span>
<span class="line"><span>- Gas 消耗：是否避免了不必要的存储操作或大循环？</span></span>
<span class="line"><span>- 是否增加了足够的注释和文档说明？是否存在未使用的代码或死代码？</span></span>
<span class="line"><span>- 是否编写了充分的单元测试覆盖常见场景和极端情况？</span></span></code></pre></div></li></ul></li></ul></li></ul></div><h4 id="_4-2-issue-管理" tabindex="-1"><a class="header-anchor" href="#_4-2-issue-管理"><span>4.2 Issue 管理</span></a></h4><figure><img src="/assets/issue_management-process_01-0H5wFPOI.jpg" alt="Issue 管理流程" tabindex="0"><figcaption>Issue 管理流程</figcaption></figure><ul><li><p>描述 Issue 结构推荐：背景 + 问题 + 尝试过的方法 + 环境信息</p><ul><li><p>示例：</p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>### 问题描述</span></span>
<span class="line"><span>执行 `forge test` 时出现 `out of gas` 错误</span></span>
<span class="line"><span></span></span>
<span class="line"><span>### 环境</span></span>
<span class="line"><span>- Foundry 版本: 0.2.0</span></span>
<span class="line"><span>- Solidity: 0.8.21</span></span></code></pre></div></li></ul></li><li><p>Issue 标签分类标准与自动化：</p><ul><li>制定统一的 Issue 标签规则，例如使用 <code>bug</code>（缺陷）、<code>enhancement</code>（增强）、<code>security</code>（安全）、<code>documentation</code>（文档）、<code>question</code>（问题）等标签；</li><li>根据需求添加 <code>high-priority</code>、<code>low-priority</code>、<code>help wanted</code> 等。</li><li>通过 GitHub Actions 等自动化工具，还可自动为新 Issue 或 PR 添加标签（如根据文件路径、标题关键字匹配标签）、标记长期未更新的 Issue 为 <code>stale</code> 等，减少人工维护成本。</li></ul></li></ul><h4 id="_4-3-开源协作礼仪" tabindex="-1"><a class="header-anchor" href="#_4-3-开源协作礼仪"><span>4.3 开源协作礼仪</span></a></h4><ul><li>所有代码变更需配测试和文档</li><li>保持沟通公开透明：Prefer PR 评论而不是私信</li><li>使用讨论区（Discussion）提重大设计变更</li></ul><h3 id="_5-layer-2-解决方案" tabindex="-1"><a class="header-anchor" href="#_5-layer-2-解决方案"><span>5. Layer 2 解决方案</span></a></h3><h4 id="_5-1-rollup-技术比较" tabindex="-1"><a class="header-anchor" href="#_5-1-rollup-技术比较"><span>5.1 Rollup 技术比较</span></a></h4><table><thead><tr><th>项目类型</th><th>原理</th><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>Optimistic Rollup</td><td>设定欺诈证明期</td><td>EVM 兼容性强，成本低</td><td>提现延迟（1~2 周）</td></tr><tr><td>ZK Rollup</td><td>零知识证明</td><td>安全性高，支持快速提现</td><td>开发难度大，不完全 EVM 兼容</td></tr></tbody></table><h4 id="_5-2-主流-l2-平台概览" tabindex="-1"><a class="header-anchor" href="#_5-2-主流-l2-平台概览"><span>5.2 主流 L2 平台概览</span></a></h4><ol><li><strong>Starknet</strong><ul><li>语言：类 Rust 语言 Cairo（非 Solidity）</li><li>特点：ZK-STARK，极高扩展性</li></ul></li><li><strong>zkSync</strong><ul><li>工具链：支持 Solidity 合约</li><li>特点：ZK Rollup，开发体验佳</li></ul></li><li><strong>Arbitrum</strong><ul><li>Optimistic 架构</li><li>特点：兼容 EVM 工具链，如 Hardhat/Foundry</li></ul></li><li><strong>Base</strong><ul><li>Coinbase 推出，构建于 OP Stack 上</li><li>特点：强生态支持，开发成本低</li></ul></li></ol><h4 id="_5-3-开发入门指南" tabindex="-1"><a class="header-anchor" href="#_5-3-开发入门指南"><span>5.3 开发入门指南</span></a></h4><p><strong>1. 环境准备</strong></p><ul><li>安装与配置：基于目标平台选择相应 SDK，如 zkSync CLI、Starknet CLI</li><li>网络设置：区分 L1 与 L2 的 RPC 端点与钱包配置（如 MetaMask L2 网络）</li><li>Devnet 本地测试：如 Starknet Devnet、zkSync Dev Node、Hardhat L2 plugin</li></ul><p><strong>2. 合约部署注意事项</strong></p><ul><li>部分平台不支持 <code>CREATE2</code> 或存在 Gas 上限差异</li><li>使用平台特定部署脚本，如 zkSync 的 <code>deploy()</code> 命令或 <code>hardhat starknet deploy</code></li><li>考虑合约地址推导方式变化（例如 zkRollup 平台不保证地址一致性）</li></ul><p><strong>3. 跨链交互与桥接</strong></p><ul><li>使用官方桥接器：如 zkSync Bridge、Arbitrum Bridge</li><li>第三方跨链协议支持：LayerZero、Axelar、Wormhole 等</li><li>跨链消息时延、费用需事先评估</li></ul><p><strong>4. 案例推荐（可拓展）</strong></p><ul><li>zkSync：Uniswap V3 fork 实践部署体验</li><li>Starknet：使用 Cairo 构建 NFT 合约与前端交互</li><li>Arbitrum：使用 Nitro 模式构建 Gas 竞拍逻辑 --&gt;</li></ul><h2 id="文章贡献者" tabindex="-1"><a class="header-anchor" href="#文章贡献者"><span><span class="vp-icon vpi-c2r6j5bo" style="color:#32b2f0;" aria-hidden data-provider="iconify"></span>文章贡献者</span></a></h2><p>作者：<a href="https://x.com/fxxkmystyle" target="_blank" rel="noopener noreferrer">Jason</a>、<a href="https://x.com/Echo_liuchan" target="_blank" rel="noopener noreferrer">Echo</a> 排版：<a href="https://x.com/Echo_liuchan" target="_blank" rel="noopener noreferrer">Echo</a> 校对：<a href="https://x.com/brucexu_eth" target="_blank" rel="noopener noreferrer">Bruce</a>、<a href="https://x.com/BoxMrChen" target="_blank" rel="noopener noreferrer">Box</a></p></div><!----><!--[--><h2 id="doc-changelog" tabindex="-1"><a href="#doc-changelog" class="header-anchor"><span>更新日志</span></a></h2><div class="vp-changelog-wrapper"><div class="vp-changelog-header"><div class="vp-latest-updated"><span class="vp-changelog-icon"></span><span data-allow-mismatch>2025/7/18 08:06</span></div><div><span class="vp-changelog-menu-icon"></span><span>查看所有更新日志</span></div></div><ul class="vp-changelog-list"><!--[--><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/7648b657df88a115b92f107c2d0ddf71cddd0a20" target="_blank" rel="noreferrer"><code>7648b</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">update: 更新「安全与合规」部分的常见网络安全风险与防护措施</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-18T08:06:24.000Z">2025/7/18</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/6607d7cdf9e5b2ab79c4ab7c55c418ce70aedbbe" target="_blank" rel="noreferrer"><code>6607d</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Fix smart contract content</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-17T20:05:42.000Z">2025/7/17</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/1a74bc91b179b2aa67f18d71c74cfbeb8c80acce" target="_blank" rel="noreferrer"><code>1a74b</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Update images</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-17T10:03:23.000Z">2025/7/17</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/6cd86cdea7a7264646f7c8d936f7707fb2e9c36c" target="_blank" rel="noreferrer"><code>6cd86</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Fix quotation marks</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-17T09:47:03.000Z">2025/7/17</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/584edb6b9e2ccedeca02b4571090550cc1ae35a9" target="_blank" rel="noreferrer"><code>584ed</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Making a better URL</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-16T03:29:51.000Z">2025/7/16</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/1f8a36c2800fe2a84583ec59d4257824ce715d47" target="_blank" rel="noreferrer"><code>1f8a3</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Fix type consistency by changing "DApp" to "Dapp" across multiple documents in the Web3 handbook.</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-15T22:57:14.000Z">2025/7/15</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/23976aaad034bc1b68497f44a04173187d47b862" target="_blank" rel="noreferrer"><code>23976</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Add new images for Discord and Twitter setup, replace deleted DApp architecture diagram, and update related documentation in the Web3 handbook.</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-15T10:51:36.000Z">2025/7/15</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/918398767bdcc2d3d327fb633e3c7b5d185d3c48" target="_blank" rel="noreferrer"><code>91839</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Update README.md and notes.ts to reflect the new smart contract development section, including updated links and improved clarity in the Web3 handbook.</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-15T09:23:35.000Z">2025/7/15</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/d4279aa7d98feba07e5162c0c41d83cf31296c23" target="_blank" rel="noreferrer"><code>d4279</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Update README.md to remove outdated mission and vision statements, and replace image references with newly added diagrams for better clarity in the Web3 handbook.</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-15T04:04:18.000Z">2025/7/15</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/f3309fb2d7b95f650883501e905093757e7f4e94" target="_blank" rel="noreferrer"><code>f3309</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Add contributing guidelines and enhance README structure for the Web3 internship handbook</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-15T03:34:02.000Z">2025/7/15</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/dcb45b02362827ebb921b87a41e9747bb380b78c" target="_blank" rel="noreferrer"><code>dcb45</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Improve image name, English version tips, and outdated info</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-14T06:32:49.000Z">2025/7/14</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/ed32b8303d9aae9909ef1601ceab320dd20d0700" target="_blank" rel="noreferrer"><code>ed32b</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">update: jason 的社交媒体信息</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-10T11:54:53.000Z">2025/7/10</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/a9dfe73a30b34afdd70d9a0f7f7aae2319c95463" target="_blank" rel="noreferrer"><code>a9dfe</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">update：隐藏「扩展阅读」</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-09T09:18:48.000Z">2025/7/9</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/5ad0531980187f6e2d91bfb7b28b57a8c04a0b2f" target="_blank" rel="noreferrer"><code>5ad05</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">update:「合规和网络安全」补充扩展阅读、「智能合约」修改内容</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-09T04:28:30.000Z">2025/7/9</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/e0c39502ca05799b8bc5567e60a9bcaea6e13ffa" target="_blank" rel="noreferrer"><code>e0c39</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">update：part2 智能合约内容</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-06-22T14:24:55.000Z">2025/6/22</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/4d9e6d51e6825d9c77694994436f5555da11ccb5" target="_blank" rel="noreferrer"><code>4d9e6</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">update: 检查所有 md 文件的中文文案排版</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-06-21T09:57:51.000Z">2025/6/21</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/75893ac870be14d619a5bd997dd7828674c11ed9" target="_blank" rel="noreferrer"><code>75893</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">docs: 更新手册所有页面的扩展阅读、文章贡献者部分，以及工作习惯部分内容</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-06-20T10:44:01.000Z">2025/6/20</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/614c288e6009220da1e6df58f89748dd9fd5ab17" target="_blank" rel="noreferrer"><code>614c2</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">feat(docs): 优化首页内容与项目结构</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-06-20T07:18:59.000Z">2025/6/20</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/ea7fbc8dc1c1638b49af8b646339649f50ada021" target="_blank" rel="noreferrer"><code>ea7fb</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Init</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-06-19T09:53:06.000Z">2025/6/19</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/1c64114c9a2cce16fe8bbd8920a5350de3a5e12a" target="_blank" rel="noreferrer"><code>1c641</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">update: 所有页面底部新增文章贡献者</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-06-19T07:49:00.000Z">2025/6/19</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/22bd35c63f1361e8d6a90e6435978b56869a52f4" target="_blank" rel="noreferrer"><code>22bd3</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">统一 Dapp 关键词</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-06-17T06:37:12.000Z">2025/6/17</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/be47d002a261fbb692d6475ed42b15293f4758d8" target="_blank" rel="noreferrer"><code>be47d</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">update part2 page2/3 、part5 page1/2/3</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-06-14T07:05:17.000Z">2025/6/14</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/21196960dfb42a29e68a6aab15e56dd419bdbdb4" target="_blank" rel="noreferrer"><code>21196</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">更新 part1</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-06-12T12:09:47.000Z">2025/6/12</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/d134cee00d9ff16eec7f7c29fc5e21b6733f6007" target="_blank" rel="noreferrer"><code>d134c</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">更新 part2</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-06-12T10:16:50.000Z">2025/6/12</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/commit/0e360e3d224593d4adb1f9bcded61e1d2921c396" target="_blank" rel="noreferrer"><code>0e360</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">update style</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-06-11T13:22:45.000Z">2025/6/11</time></span></li><!--]--></ul></div><!--]--><div class="vp-doc-copyright" data-v-23f6ad98><h2 id="doc-copyright" tabindex="-1" class="vp-doc-header" data-v-309da98c><a href="#doc-copyright" class="header-anchor" data-v-309da98c><span data-v-309da98c><!--[-->版权所有<!--]--></span></a></h2><div class="hint-container tip copyright-container" data-v-22c67d2a><p data-v-22c67d2a><span data-v-22c67d2a>版权归属：</span><span class="vp-link no-icon" data-v-22c67d2a data-v-17a67ebe><!--[-->ETHPanda &amp; LXDAO Community<!--]--><!----></span></p><!----><p data-v-22c67d2a><span data-v-22c67d2a>许可证：</span><a class="vp-link no-icon link" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noreferrer" data-v-22c67d2a data-v-17a67ebe><!--[-->署名-非商业性-相同方式共享 4.0 国际 (CC-BY-NC-SA-4.0)<!--]--><!----></a><!--[--><span class="vpi-license-cc" data-v-22c67d2a></span><span class="vpi-license-by" data-v-22c67d2a></span><span class="vpi-license-nc" data-v-22c67d2a></span><span class="vpi-license-sa" data-v-22c67d2a></span><!--]--></p></div></div></div></main><footer class="vp-doc-footer" data-v-23f6ad98 data-v-fda6bbae><!--[--><!--]--><div class="edit-info" data-v-fda6bbae><div class="edit-link" data-v-fda6bbae><a class="vp-link no-icon link edit-link-button" href="https://github.com/ethpanda-org/Web3-Internship-Handbook/edit/main/docs/zh/part2/smart-contract-development.md" target="_blank" rel="noreferrer" data-v-fda6bbae data-v-17a67ebe><!--[--><span class="vpi-square-pen edit-link-icon" aria-label="edit icon" data-v-fda6bbae></span> 编辑此页<!--]--><!----></a></div><!----></div><div class="contributors" aria-label="Contributors" data-v-fda6bbae><span class="contributors-label" data-v-fda6bbae>贡献者: </span><span class="contributors-info" data-v-fda6bbae><!--[--><!--[--><span class="contributor" data-v-fda6bbae>“EchoZheng2333”</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" data-v-fda6bbae>Bruce Xu</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" data-v-fda6bbae>wangshouh</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" data-v-fda6bbae>EchoZheng2333</span><!----><!--]--><!--]--></span></div><nav class="prev-next" data-v-fda6bbae><div class="pager" data-v-fda6bbae><a class="vp-link no-icon link pager-link prev" href="/zh/position-introduction/" data-v-fda6bbae data-v-17a67ebe><!--[--><span class="desc" data-v-fda6bbae>上一页</span><span class="title" data-v-fda6bbae>区块链岗位全景图</span><!--]--><!----></a></div><div class="pager" data-v-fda6bbae><a class="vp-link no-icon link pager-link next" href="/zh/community-intern/" data-v-fda6bbae data-v-17a67ebe><!--[--><span class="desc" data-v-fda6bbae>下一页</span><span class="title" data-v-fda6bbae>社区运营指南</span><!--]--><!----></a></div></nav></footer><!----><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-d90a7a26 data-v-bcf8d9a6><span class="percent" data-allow-mismatch data-v-bcf8d9a6>0%</span><span class="show icon vpi-back-to-top" data-v-bcf8d9a6></span><svg aria-hidden="true" data-v-bcf8d9a6><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-bcf8d9a6></circle></svg></button><footer class="vp-footer has-sidebar" vp-footer data-v-d90a7a26 data-v-400675cf><!--[--><div class="container" data-v-400675cf><p class="message" data-v-400675cf>© Web3 实习手册 | 由 ETHPanda 和 LXDAO 团队维护</p><!----></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-BJ-erunQ.js" defer></script></body></html>